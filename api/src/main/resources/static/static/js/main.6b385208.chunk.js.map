{"version":3,"sources":["utils/TimeUtils.ts","handlers/DownloadHandler.tsx","components/SearchBar.tsx","model/Diary.ts","components/DiaryList.tsx","components/DiaryModal.tsx","hooks/EditModalHooks.tsx","utils/DiaryAPI.ts","handlers/SearchHandler.tsx","handlers/ModalHandler.tsx","DiaryRoot.tsx","hooks/DiaryHooks.tsx","Login.tsx","App.tsx","hooks/LoginHooks.tsx","serviceWorker.ts","index.tsx"],"names":["encodeDate","date","getFullYear","zeroPadding","getMonth","getDate","getHours","getMinutes","getSeconds","fixDate","begin","result","Date","setHours","setMinutes","setSeconds","num","slice","encodeDiary2Raw","diary","inner_user_id","diary_id","update_date","wheather","feeling","text","useStyles","makeStyles","theme","createStyles","grow","flexGrow","menuButton","marginRight","spacing","title","display","breakpoints","up","search","position","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","width","searchIcon","padding","height","pointerEvents","alignItems","justifyContent","inputRoot","color","inputInput","paddingLeft","transition","transitions","create","filterIcon","right","popover","popoverSearchButton","marginTop","SearchBar","onEnter","filter","userInfo","diaries","classes","useState","filterAnchor","setFilterAnchor","filterOpen","Boolean","filterId","undefined","handleFilterClick","useCallback","event","currentTarget","inputRef","useRef","handleFilterClose","current","value","handleInputEnter","key","handleDownloadClick","raws","reverse","map","fileStr","JSON","stringify","blob","Blob","link","document","createElement","href","window","URL","createObjectURL","download","click","downloadDiaries","className","AppBar","Toolbar","IconButton","edge","aria-label","Typography","variant","noWrap","SearchTextField","filterEnabled","from","disabled","onKeyPress","onFilterClick","DateRangeSwitcher","to","open","onClose","id","onClick","UserMenu","userName","onLogout","InputBase","placeholder","root","input","inputProps","aria-controls","aria-haspopup","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","FormControlLabel","control","Switch","checked","onChange","onDisabled","target","name","label","DatePicker","format","disableFuture","minDate","React","setAnchorEl","isMenuOpen","handleMenuClose","menuId","Menu","keepMounted","MenuItem","Wheather","decodeWheather","Feeling","decodeFeeling","columns","minWidth","toLocaleString","length","container","pagment","bottom","borderTop","margin","row","cursor","DiaryList","onSelected","pageReset","page","setPage","rowsPerPage","setRowsPerPage","handleChangePage","newPage","handleChangeRowsPerPage","useEffect","Paper","TableContainer","Table","stickyHeader","TableHead","TableRow","column","TableCell","align","style","TableBody","hover","role","tabIndex","TablePagination","rowsPerPageOptions","component","count","onChangePage","onChangeRowsPerPage","modal","paper","background","maxWidth","boxShadow","shadows","enterEdit","textOverFlow","maxHeight","overflow","editTextMargin","editButtonWrapper","delete","close","DiaryModal","selectTarget","edit","normalBody","ViewBody","editBody","EditBody","Modal","aria-labelledby","aria-describedby","disableBackdropClick","closeAfterTransition","BackdropComponent","Backdrop","BackdropProps","timeout","Fade","in","disableStrictModeCompat","Fab","size","saveHandler","deleteHandler","cancelHandler","setDate","handleDateChange","setWheather","setFeeling","textRef","handleOnDelete","handleOnSave","handleOnClose","handleWChange","handleFChange","useEditModal","DateTimePicker","ampm","FormControl","Select","rows","defaultValue","multiline","fullWidth","rowsMax","fontSize","DiaryAPI","searchInput","fromDate","toDate","end_date","body","fetch","this","URI","SEARCH","method","POST","headers","HEADERS","stringifyBody","res","ok","Error","statusText","json","encodeRaw2Diary","DIARY","PUT","DELETE","_","v","searchDiaries","setDiaries","getDates","a","dates","getSaveHandler","setFilter","onSearch","setModalStatus","dateHasChanged","getTime","wheatherHasChanged","feelingHasChanged","textHasChanged","alert","confirm","update","message","getDeleteHandler","getCancelHandler","getDiaryTemplate","getEmpty","insert","getDeleteAndCancelHandler","addIcon","DiaryRoot","innerUserId","setTarget","useDiaryList","resetPage","setResetPage","init_open","init_edit","setOpen","setEdit","useModal","setToDate","setFromDate","fromDisabled","setFromDisabled","toDisabled","setToDisabled","useSearchBar","getHandler","handleModalClose","createNew","toggleEdit","Copyright","Link","flexDirection","avatar","primary","main","form","submit","Login","onLogin","idRef","handleOnLogin","userId","Container","CssBaseline","Avatar","TextField","required","autoFocus","Button","type","Box","mt","App","setInnerUserId","setUserName","error","user_name","useLogin","utils","DateFnsUtils","locale","jaLocale","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","console"],"mappings":"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","file":"static/js/main.6b385208.chunk.js","sourcesContent":["\r\nexport default function encodeDate(date: Date) {\r\n  return (\r\n    date.getFullYear() + '-' + \r\n        zeroPadding(date.getMonth() + 1) + '-' + \r\n        zeroPadding(date.getDate()) + 'T' +\r\n        zeroPadding(date.getHours()) + ':' +\r\n        zeroPadding(date.getMinutes()) + ':' +\r\n        zeroPadding(date.getSeconds()) + '.0'\r\n  );\r\n}\r\n\r\nexport function fixDate(date: Date, begin: boolean): Date {\r\n  const result = new Date(date);\r\n\r\n  result.setHours(begin ? 0 : 23);\r\n  result.setMinutes(begin ? 0 : 59);\r\n  result.setSeconds(begin ? 0 : 59);\r\n\r\n  return result;\r\n}\r\n\r\nfunction zeroPadding(num: number): string {\r\n  return ('0' + num).slice(-2);\r\n}","import { Diary, RawDiary } from \"../model/Diary\";\r\nimport encodeDate from \"../utils/TimeUtils\";\r\n\r\nexport function downloadDiaries(diaries: Diary[]): void {\r\n  const raws = [...diaries].reverse().map(encodeDiary2Raw);\r\n\r\n  const fileStr = JSON.stringify({diaries: raws});\r\n\r\n  const blob = new Blob(\r\n    [fileStr],\r\n    {\"type\": \"text/plain\"}\r\n  );\r\n\r\n  const link = document.createElement('a');\r\n  link.href = window.URL.createObjectURL(blob);\r\n  link.download = 'diaries.json';\r\n  link.click();\r\n}\r\n\r\nfunction encodeDiary2Raw(diary: Diary): RawDiary {\r\n  return {\r\n    inner_user_id: diary.inner_user_id || 0,\r\n    diary_id: diary.diary_id || 0,\r\n    date: encodeDate(diary.date),\r\n    update_date: encodeDate(diary.update_date || new Date()),\r\n    wheather: diary.wheather,\r\n    feeling: diary.feeling,\r\n    text: diary.text\r\n  }\r\n}","import React, { useCallback, useRef, useState } from 'react';\r\nimport { fade, makeStyles, Theme, createStyles } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport ImportContactsIcon from '@material-ui/icons/ImportContacts';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle';\r\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport { FormControlLabel, Popover, Switch } from '@material-ui/core';\r\nimport { DatePicker } from '@material-ui/pickers';\r\nimport { MaterialUiPickersDate } from '@material-ui/pickers/typings/date';\r\nimport { Diary } from '../model/Diary';\r\nimport { downloadDiaries } from '../handlers/DownloadHandler';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    grow: {\r\n      flexGrow: 1,\r\n    },\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n    title: {\r\n      display: 'none',\r\n      [theme.breakpoints.up('sm')]: {\r\n        display: 'block',\r\n      },\r\n    },\r\n    search: {\r\n      position: 'relative',\r\n      borderRadius: theme.shape.borderRadius,\r\n      backgroundColor: fade(theme.palette.common.white, 0.15),\r\n      '&:hover': {\r\n        backgroundColor: fade(theme.palette.common.white, 0.25),\r\n      },\r\n      marginRight: theme.spacing(2),\r\n      marginLeft: 0,\r\n      width: '100%',\r\n      [theme.breakpoints.up('sm')]: {\r\n        marginLeft: theme.spacing(3),\r\n        width: 'auto',\r\n      },\r\n    },\r\n    searchIcon: {\r\n      padding: theme.spacing(0, 2),\r\n      height: '100%',\r\n      position: 'absolute',\r\n      pointerEvents: 'none',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n    },\r\n    inputRoot: {\r\n      color: 'inherit',\r\n    },\r\n    inputInput: {\r\n      padding: theme.spacing(1, 1, 1, 0),\r\n      paddingLeft: `calc(1em + ${theme.spacing(4)}px)`,\r\n      transition: theme.transitions.create('width'),\r\n      width: '100%',\r\n      [theme.breakpoints.up('md')]: {\r\n        width: '20ch',\r\n      },\r\n    },\r\n    filterIcon: {\r\n      position: 'absolute',\r\n      right: 0,\r\n      height: '100%',\r\n      padding: '0 12px'\r\n    },\r\n    popover: {\r\n      padding: '12px',\r\n    },\r\n    popoverSearchButton: {\r\n      marginTop: '10px',\r\n      display: 'flex',\r\n      justifyContent: 'flex-end'\r\n    }\r\n  }),\r\n);\r\n\r\ntype DateSwitch = {\r\n  date: Date;\r\n  disabled: boolean;\r\n  onChange: (date: MaterialUiPickersDate) => void;\r\n  onDisabled: (disabled: boolean) => void;\r\n}\r\nexport type Filter = {\r\n  from: DateSwitch,\r\n  to: DateSwitch\r\n};\r\ntype PrimarySearchAppBar = {\r\n  onEnter: (input: string) => void;\r\n  filter: Filter;\r\n  userInfo: {\r\n    userName: string;\r\n    onLogout: () => void;\r\n  },\r\n  diaries: Diary[]\r\n};\r\nexport default function SearchBar({ onEnter, filter, userInfo, diaries }: PrimarySearchAppBar) {\r\n  const classes = useStyles();\r\n\r\n  const [filterAnchor, setFilterAnchor] = useState<HTMLButtonElement | null>(null);\r\n  const filterOpen = Boolean(filterAnchor);\r\n  const filterId = filterOpen ? 'filter-popover' : undefined;\r\n  \r\n  const handleFilterClick = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {\r\n    setFilterAnchor(event.currentTarget);\r\n  }, [setFilterAnchor]);\r\n\r\n  const inputRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const handleFilterClose = useCallback(() => {\r\n    onEnter(inputRef.current ? inputRef.current.value : \"\");\r\n    setFilterAnchor(null);\r\n  }, [onEnter, setFilterAnchor]);\r\n\r\n  const handleInputEnter = useCallback((event: React.KeyboardEvent<HTMLDivElement>): void => {\r\n    if ('Enter' === event.key)\r\n      onEnter(inputRef.current ? inputRef.current.value : \"\");\r\n  }, [onEnter]);\r\n\r\n  const handleDownloadClick = useCallback(() => downloadDiaries(diaries), [diaries]);\r\n  \r\n  return (\r\n    <div className={classes.grow}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <IconButton\r\n            edge=\"start\"\r\n            className={classes.menuButton}\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n          >\r\n            <ImportContactsIcon />\r\n          </IconButton>\r\n          <Typography className={classes.title} variant=\"h6\" noWrap>\r\n            Web Diary\r\n          </Typography>\r\n          <div className={classes.search}>\r\n            <SearchTextField \r\n              inputRef={inputRef}\r\n              filterId={filterId}\r\n              filterEnabled={!filter.from.disabled}\r\n              onKeyPress={handleInputEnter}\r\n              onFilterClick={handleFilterClick}\r\n            />\r\n            <DateRangeSwitcher \r\n              from={filter.from}\r\n              to={filter.to}\r\n              open={filterOpen}\r\n              filterAnchor={filterAnchor}\r\n              onClose={handleFilterClose}\r\n              id={filterId}\r\n            />\r\n          </div>\r\n          <IconButton color='inherit' onClick={handleDownloadClick}>\r\n            <CloudDownloadIcon />\r\n          </IconButton>\r\n          <UserMenu userName={userInfo.userName} onLogout={userInfo.onLogout} />\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  );\r\n}\r\n\r\ntype SearchTextField = {\r\n  onKeyPress: ((event: React.KeyboardEvent<HTMLDivElement>) => void) | undefined;\r\n  onFilterClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n  filterId: string | undefined;\r\n  filterEnabled: boolean;\r\n  inputRef: React.RefObject<HTMLTextAreaElement>;\r\n}\r\nfunction SearchTextField({ onKeyPress, onFilterClick, filterId, filterEnabled, inputRef }: SearchTextField): JSX.Element {\r\n  const classes = useStyles();\r\n  return (\r\n    <>\r\n      <div className={classes.searchIcon}>\r\n        <SearchIcon />\r\n      </div>\r\n      <InputBase\r\n        inputRef={inputRef}\r\n        placeholder=\"Search…\"\r\n        onKeyPress={onKeyPress}\r\n        classes={{\r\n        root: classes.inputRoot,\r\n        input: classes.inputInput,\r\n        }}\r\n        inputProps={{ 'aria-label': 'search' }}\r\n      />\r\n      <IconButton \r\n        className={classes.filterIcon}\r\n        aria-label=\"date-filter\"\r\n        aria-controls={filterId}\r\n        aria-haspopup=\"true\"\r\n        color={filterEnabled ? 'secondary' : 'inherit'}\r\n        onClick={onFilterClick}\r\n      >\r\n        <FilterListIcon />\r\n      </IconButton>\r\n    </>\r\n  );\r\n}\r\n\r\ntype Switcher = {\r\n  from: DateSwitch;\r\n  to: DateSwitch;\r\n  open: boolean;\r\n  filterAnchor: HTMLButtonElement | null;\r\n  onClose: () => any;\r\n  id: string | undefined;\r\n};\r\nfunction DateRangeSwitcher({ from, to, open, filterAnchor, onClose, id }: Switcher): JSX.Element {\r\n  const classes = useStyles();\r\n\r\n  const handleSwitchChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    from.onDisabled(!event.target.checked);\r\n    if (!event.target.checked)\r\n      to.onDisabled(!event.target.checked);\r\n  };\r\n\r\n  const handleToSwitchChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    to.onDisabled(!event.target.checked);\r\n  };\r\n\r\n  return (\r\n    <Popover\r\n      id={id}\r\n      open={open}\r\n      anchorEl={filterAnchor}\r\n      onClose={onClose}\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'center'\r\n      }}\r\n      transformOrigin={{\r\n        vertical: 'top',\r\n        horizontal: 'center'\r\n      }}\r\n    >\r\n      <div className={classes.popover}>\r\n        <FormControlLabel \r\n          control={\r\n            <Switch\r\n              checked={!from.disabled}\r\n              onChange={handleSwitchChange}\r\n              color='primary'\r\n              name='switch date filter'\r\n              inputProps={{ 'aria-label': 'enable date filter' }}\r\n            />\r\n          }\r\n          label=\"enable date filter\"\r\n        />\r\n        <div>\r\n          <DatePicker \r\n            disabled={from.disabled}\r\n            label=\"from\"\r\n            variant='inline'\r\n            value={from.date}\r\n            onChange={from.onChange}\r\n            format='yyyy/MM/dd'\r\n            disableFuture\r\n          />\r\n          <div>\r\n            <Switch\r\n              disabled={from.disabled}\r\n              checked={!to.disabled}\r\n              onChange={handleToSwitchChange}\r\n              color=\"primary\"\r\n              name=\"switch to date\"\r\n              inputProps={{ 'aria-label': 'to date checkbox' }}\r\n            />\r\n            <DatePicker \r\n              label=\"to\"\r\n              variant='inline'\r\n              value={to.date}\r\n              onChange={to.onChange}\r\n              format='yyyy/MM/dd'\r\n              disableFuture\r\n              disabled={to.disabled}\r\n              minDate={from.date}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Popover>\r\n  );\r\n}\r\n\r\ntype UserMenu = {\r\n  userName: string;\r\n  onLogout: () => void;\r\n}\r\nfunction UserMenu({ userName, onLogout }: UserMenu): JSX.Element {\r\n  const classes = useStyles();\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n\r\n  const isMenuOpen = Boolean(anchorEl);\r\n\r\n  const handleProfileMenuOpen = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleMenuClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const menuId = 'primary-search-account-menu';\r\n\r\n  return (\r\n    <>\r\n      <div className={classes.grow} />\r\n        <IconButton\r\n          aria-label=\"account of current user\"\r\n          aria-controls={menuId}\r\n          aria-haspopup=\"true\"\r\n          onClick={handleProfileMenuOpen}\r\n          color=\"inherit\"\r\n        >\r\n          <AccountCircle />\r\n        </IconButton>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n          id={menuId}\r\n          keepMounted\r\n          transformOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n          open={isMenuOpen}\r\n          onClose={handleMenuClose}\r\n        >\r\n          <MenuItem onClick={handleMenuClose}>{userName}</MenuItem>\r\n          <MenuItem onClick={onLogout}>Logout</MenuItem>\r\n        </Menu>\r\n    </>\r\n  )\r\n}","export type RawDiary = {\r\n  inner_user_id: number;\r\n  diary_id: number;\r\n  date: string;\r\n  update_date: string;\r\n  wheather: number;\r\n  feeling: number;\r\n  text: string;\r\n};\r\n\r\nexport type Diary = {\r\n  inner_user_id?: number;\r\n  diary_id?: number;\r\n  date: Date;\r\n  end_date?: Date;\r\n  update_date?: Date;\r\n  wheather: number;\r\n  feeling: number;\r\n  text: string;\r\n};\r\n\r\nconst Wheather = {\r\n  SUNNY: 0,\r\n  CLOUDY: 1,\r\n  RAINY: 2,\r\n  THUNDER: 3,\r\n  SNOW: 4,\r\n  WIND: 5\r\n} as const;\r\ntype Wheather = typeof Wheather[keyof typeof Wheather];\r\n\r\nfunction decodeWheather(wheather: number): string {\r\n  switch(wheather) {\r\n    case(Wheather.SUNNY):\r\n      return '🔆';\r\n    case(Wheather.CLOUDY):\r\n      return '☁';\r\n    case(Wheather.RAINY):\r\n      return '☔';\r\n    case(Wheather.THUNDER):\r\n      return '⚡';\r\n    case(Wheather.SNOW):\r\n      return '⛄';\r\n    case(Wheather.WIND):\r\n      return '🌀';\r\n    default:\r\n      return '🔆';\r\n  };\r\n}\r\n\r\nconst Feeling = {\r\n  HAPPY: 0,\r\n  NORMAL: 1,\r\n  LIT_SAD: 2,\r\n  SAD: 3,\r\n  ANGRY: 4\r\n} as const;\r\ntype Feeling = typeof Feeling[keyof typeof Feeling];\r\n\r\nfunction decodeFeeling(feeling: number): string {\r\n  switch(feeling) {\r\n    case(Feeling.HAPPY):\r\n      return '😀';\r\n    case(Feeling.NORMAL):\r\n      return '😐';\r\n    case(Feeling.LIT_SAD):\r\n      return '😥';\r\n    case(Feeling.SAD):\r\n      return '😭';\r\n    case(Feeling.ANGRY):\r\n      return '😡';\r\n    default:\r\n      return '😀';\r\n  };\r\n}\r\n\r\nexport { Wheather, decodeWheather, Feeling, decodeFeeling };","import React, { useEffect } from 'react';\r\nimport { useState, useCallback } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\n\r\nimport { Diary, decodeWheather, decodeFeeling } from '../model/Diary';\r\n\r\ntype Column = {\r\n  id: 'date' | 'wheather' | 'feeling' | 'text';\r\n  label: string;\r\n  minWidth?: number;\r\n  align?: 'center';\r\n  format?: (value: any) => string;\r\n};\r\n\r\nconst columns: Column[] = [\r\n  { id: 'date', label: 'Date', minWidth: 20, format: (value: Date) => value.toLocaleString() },\r\n  { id: 'wheather', label: 'Weather', minWidth: 20, format: (value: number) => decodeWheather(value) },\r\n  { id: 'feeling', label: 'Feelings', minWidth: 20, format: (value: number) => decodeFeeling(value) },\r\n  { id: 'text', label: 'Export', minWidth: 170, format: (value: string) => value.length > 100 ? value.slice(0, 100) + '...' : value }\r\n];\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    width: '100%'\r\n  },\r\n  container: {\r\n    height: 'calc(100vh - 110px)'\r\n  },\r\n  pagment: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    backgroundColor: '#fafafa',\r\n    borderTop: '1px solid rgba(0, 0, 0, 0.15)',\r\n    width: '100%',\r\n    margin: 0\r\n  },\r\n  row: {\r\n    cursor: 'pointer'\r\n  }\r\n});\r\n\r\ntype DiaryList = {\r\n  diaries: Diary[];\r\n  onSelected: (target: Diary) => void;\r\n  pageReset: boolean;\r\n};\r\nexport default function DiaryList({ diaries, onSelected, pageReset }: DiaryList) {\r\n  const classes = useStyles();\r\n  const [page, setPage] = useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = useState(25);\r\n\r\n  const handleChangePage = useCallback((event: unknown, newPage: number) => {\r\n    setPage(newPage);\r\n  }, []);\r\n\r\n  const handleChangeRowsPerPage = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setRowsPerPage(+event.target.value);\r\n    setPage(0);\r\n  }, []);\r\n\r\n  useEffect(() => pageReset ? setPage(0) : void(0), [pageReset]);\r\n\r\n  return (\r\n    <Paper className={classes.root}>\r\n      <TableContainer className={classes.container}>\r\n        <Table stickyHeader aria-label=\"sticky table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              {columns.map((column) => (\r\n                <TableCell\r\n                  key={column.id}\r\n                  align={column.align}\r\n                  style={{ minWidth: column.minWidth }}\r\n                >\r\n                  {column.label}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {diaries.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map((diary) => {\r\n              return (\r\n                <TableRow\r\n                  className={classes.row}\r\n                  key={diary.diary_id}\r\n                  hover \r\n                  role=\"checkbox\" \r\n                  tabIndex={-1}\r\n                  onClick={(event) => onSelected(diary)}\r\n                >\r\n                  {columns.map((column) => {\r\n                    const value = diary[column.id];\r\n                    return (\r\n                      <TableCell key={column.id} align={column.align}>\r\n                        {column.format ? column.format(value) : value}\r\n                      </TableCell>\r\n                    );\r\n                  })}\r\n                </TableRow>\r\n              );\r\n            })}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <TablePagination\r\n        className={classes.pagment}\r\n        rowsPerPageOptions={[10, 25, 100]}\r\n        component=\"div\"\r\n        count={diaries.length}\r\n        rowsPerPage={rowsPerPage}\r\n        page={page}\r\n        onChangePage={handleChangePage}\r\n        onChangeRowsPerPage={handleChangeRowsPerPage}\r\n      />\r\n    </Paper>\r\n  );\r\n}\r\n\r\n","import { createStyles, FormControl, InputBase, makeStyles, MenuItem, Modal, Select, Theme } from '@material-ui/core';\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport Fade from '@material-ui/core/Fade';\r\nimport React from 'react';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport NavigationIcon from '@material-ui/icons/Navigation';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\n\r\nimport {\r\n  Diary, Wheather, Feeling, decodeWheather, decodeFeeling\r\n} from '../model/Diary';\r\nimport useEditModal from '../hooks/EditModalHooks';\r\nimport { SelectTarget } from '../hooks/DiaryHooks';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    modal: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n    },\r\n    paper: {\r\n      position: 'relative',\r\n      backgroundColor: theme.palette.background.paper,\r\n      width: '80%',\r\n      maxWidth: '768px',\r\n      boxShadow: theme.shadows[5],\r\n      padding: theme.spacing(2, 4, 3),\r\n      borderRadius: '10px',\r\n      '& h2, p': {\r\n        cursor: 'default'\r\n      }\r\n    },\r\n    enterEdit: {\r\n      position: 'relative',\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      marginTop: '1%'\r\n    },\r\n    textOverFlow: {\r\n      width: '100%',\r\n      margin: 0,\r\n      maxHeight: '50vh',\r\n      overflow: 'auto'\r\n    },\r\n    editTextMargin: {\r\n      marginTop: '1%',\r\n    },\r\n    editButtonWrapper: {\r\n      width: '100%',\r\n      display: 'flex',\r\n      justifyContent: 'space-evenly'\r\n    },\r\n    delete: {\r\n      width: '50%'\r\n    },\r\n    close: {\r\n      width: '50%',\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      '& button': {\r\n        marginLeft: '1%'\r\n      }\r\n    }\r\n  }),\r\n);\r\n\r\ntype DiaryModal = {\r\n  selectTarget: SelectTarget;\r\n  open: boolean;\r\n  edit: boolean;\r\n  enterEdit: () => void;\r\n  onClose: () => void;\r\n}\r\nexport default function DiaryModal({ selectTarget, open, edit, enterEdit, onClose }: DiaryModal): JSX.Element {\r\n  const classes = useStyles();\r\n\r\n  const normalBody = (\r\n    <ViewBody\r\n      diary={selectTarget.diary}\r\n      onClick={enterEdit}\r\n    />\r\n  );\r\n\r\n  const editBody = (\r\n    <EditBody\r\n      selectTarget={selectTarget}\r\n    />\r\n  );\r\n  \r\n  return (\r\n    <Modal\r\n      aria-labelledby='transition-modal-title'\r\n      aria-describedby='transition-modal-description'\r\n      disableBackdropClick={edit}\r\n      className={classes.modal}\r\n      open={open}\r\n      onClose={onClose}\r\n      closeAfterTransition\r\n      BackdropComponent={Backdrop}\r\n      BackdropProps={{\r\n        timeout: 500,\r\n      }}\r\n    >\r\n      <Fade in={open} disableStrictModeCompat>\r\n        <>\r\n          {edit ? editBody : normalBody}\r\n        </>\r\n      </Fade>\r\n    </Modal>\r\n  );\r\n}\r\n\r\ntype ViewBody = {\r\n  diary: Diary;\r\n  onClick: () => void;\r\n}\r\nexport function ViewBody({ diary, onClick }: ViewBody) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div className={classes.paper}>\r\n      <h2 id='transition-modal-title'>\r\n        {diary.date.toLocaleString() + \" \" + decodeWheather(diary.wheather) + \" \" + decodeFeeling(diary.feeling)}\r\n      </h2>\r\n      <p id='transition-modal-description' className={classes.textOverFlow}>{diary.text}</p>\r\n      <div className={classes.enterEdit}>\r\n        <Fab color=\"secondary\" aria-label=\"edit\" size='medium' onClick={onClick}>\r\n          <EditIcon />\r\n        </Fab>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\ntype EditBody = {\r\n  selectTarget: SelectTarget;\r\n}\r\nexport function EditBody({ selectTarget }: EditBody) {\r\n  const classes = useStyles();\r\n  const { diary } = selectTarget;\r\n  const { \r\n    date, wheather, feeling, textRef,\r\n    handleDateChange, handleWChange, handleFChange,\r\n    handleOnSave, handleOnClose, handleOnDelete\r\n  } = useEditModal(selectTarget);\r\n\r\n  return (\r\n    <div className={classes.paper}>\r\n      <DateTimePicker \r\n        value={date} \r\n        variant='inline'\r\n        onChange={handleDateChange}\r\n        ampm={false}\r\n        disableFuture\r\n        format='yyyy/MM/dd HH:mm'\r\n      />\r\n      <FormControl >\r\n        <Select \r\n          value={wheather}\r\n          onChange={handleWChange}\r\n        > \r\n          <MenuItem value={Wheather.SUNNY}>\r\n            <span role='img' aria-label='sunny'>{decodeWheather(Wheather.SUNNY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.CLOUDY}>\r\n            <span role='img' aria-label='cloudy'>{decodeWheather(Wheather.CLOUDY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.RAINY}>\r\n            <span role='img' aria-label='rainy'>{decodeWheather(Wheather.RAINY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.THUNDER}>\r\n            <span role='img' aria-label='thunder'>{decodeWheather(Wheather.THUNDER)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.SNOW}>\r\n            <span role='img' aria-label='snow'>{decodeWheather(Wheather.SNOW)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.WIND}>\r\n            <span role='img' aria-label='wind'>{decodeWheather(Wheather.WIND)}</span>\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n      <FormControl>\r\n        <Select\r\n          value={feeling}\r\n          onChange={handleFChange}\r\n        >\r\n          <MenuItem value={Feeling.HAPPY}>\r\n            <span role='img' aria-label='happy'>{decodeFeeling(Feeling.HAPPY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.NORMAL}>\r\n            <span role='img' aria-label='normal'>{decodeFeeling(Feeling.NORMAL)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.LIT_SAD}>\r\n            <span role='img' aria-label='little-bit-sad'>{decodeFeeling(Feeling.LIT_SAD)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.SAD}>\r\n            <span role='img' aria-label='sad'>{decodeFeeling(Feeling.SAD)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.ANGRY}>\r\n            <span role='img' aria-label='angry'>{decodeFeeling(Feeling.ANGRY)}</span>\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n      <InputBase\r\n        inputRef={textRef}\r\n        className={classes.editTextMargin}\r\n        rows={20}\r\n        defaultValue={diary.text}\r\n        multiline\r\n        fullWidth\r\n        rowsMax={20}\r\n        inputProps={{ 'aria-label': 'naked' }}\r\n      />\r\n      <div className={classes.editButtonWrapper}>\r\n        <div className={classes.delete}>\r\n          <IconButton\r\n            onClick={handleOnDelete}\r\n            aria-label=\"delete\"\r\n          >\r\n            <DeleteIcon fontSize=\"small\" />\r\n          </IconButton>\r\n        </div>\r\n        <div className={classes.close}>\r\n          <Fab\r\n            onClick={handleOnSave}\r\n            variant=\"extended\"\r\n            size=\"medium\"\r\n            color=\"primary\"\r\n            aria-label=\"add\"\r\n          >\r\n            <NavigationIcon />\r\n            保存\r\n          </Fab>\r\n          <IconButton \r\n            aria-label='close' \r\n            onClick={handleOnClose}\r\n          >\r\n            <CloseIcon fontSize='small'/>\r\n          </IconButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { RefObject, useCallback, useRef, useState } from \"react\";\r\nimport { SelectTarget } from \"./DiaryHooks\";\r\n\r\nexport type UseEditModal = {\r\n  date: Date;\r\n  wheather: number;\r\n  feeling: number;\r\n  textRef: RefObject<HTMLTextAreaElement>;\r\n  handleDateChange: (date: any) => void;\r\n  handleWChange: (event: React.ChangeEvent<{value: unknown;}>) => void;\r\n  handleFChange: (event: React.ChangeEvent<{value: unknown;}>) => void;\r\n  handleOnSave: () => void;\r\n  handleOnClose: () => void;\r\n  handleOnDelete: () => void\r\n}\r\nexport default function useEditModal(selectTarget: SelectTarget): UseEditModal {\r\n  const { diary, saveHandler, deleteHandler, cancelHandler } = selectTarget;\r\n\r\n  const [date, setDate] = useState(diary.date);\r\n  const handleDateChange = useCallback((date) => setDate(date), []);\r\n\r\n  const [wheather, setWheather] = useState(diary.wheather);\r\n  const handleWChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    setWheather(event.target.value as number);\r\n  };\r\n  \r\n  const [feeling, setFeeling] = useState(diary.feeling);\r\n  const handleFChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    setFeeling(event.target.value as number);\r\n  };\r\n\r\n  const textRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const handleOnDelete = useCallback(() => {\r\n    deleteHandler()\r\n  }, [deleteHandler]);\r\n  \r\n  const handleOnSave = useCallback(() => {\r\n    const text = textRef.current ? textRef.current.value : \"\";\r\n    saveHandler({ date, wheather, feeling, text });\r\n  }, [date, feeling, saveHandler, wheather]);\r\n\r\n  const handleOnClose = useCallback(() => {\r\n    cancelHandler();\r\n  }, [cancelHandler]);\r\n\r\n  return {\r\n    date, \r\n    wheather, \r\n    feeling, \r\n    textRef,\r\n    handleDateChange, \r\n    handleWChange, \r\n    handleFChange,\r\n    handleOnDelete,\r\n    handleOnSave,\r\n    handleOnClose\r\n  };\r\n}","import { RawDiary, Diary } from '../model/Diary';\r\nimport encodeDate, { fixDate } from './TimeUtils';\r\n\r\nexport default class DiaryAPI {\r\n  private static URI = '../web_diary/';\r\n  private static DIARY = 'diary/';\r\n  private static SEARCH = 'search/';\r\n\r\n  private static POST = 'POST';\r\n  private static PUT = 'PUT';\r\n  private static DELETE = 'DELETE';\r\n\r\n  private static HEADERS = {\r\n    'Content-Type': 'application/json'\r\n  };\r\n\r\n  public static async search(\r\n    inner_user_id: number, \r\n    searchInput: string | null, \r\n    fromDate: Date | null, \r\n    toDate: Date | null\r\n  ): Promise<Diary[]> {\r\n\r\n    let date: Date | null;\r\n    let end_date: Date | null;\r\n    if (fromDate && toDate) {\r\n      date = fixDate(fromDate, true);\r\n      end_date = fixDate(toDate, false);\r\n    } else if (fromDate && !toDate) {\r\n      date = fixDate(fromDate, true);\r\n      end_date = fixDate(fromDate, false);\r\n    } else {\r\n      date = null;\r\n      end_date = null;\r\n    }\r\n\r\n    if (!fromDate && !toDate && !searchInput) return [];\r\n\r\n    const body = {\r\n      inner_user_id,\r\n      text: searchInput,\r\n      date: date && encodeDate(date),\r\n      end_date: end_date && encodeDate(end_date)\r\n    };\r\n\r\n    const res = await fetch(\r\n      `${this.URI}${this.SEARCH}`,\r\n      {\r\n        method: this.POST,\r\n        headers: this.HEADERS,\r\n        body: this.stringifyBody(body)\r\n      }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n\r\n    const raws: RawDiary[] = (await res.json()).diaries;\r\n\r\n    return raws.map(this.encodeRaw2Diary).reverse();\r\n  }\r\n\r\n  public static async insert(\r\n    inner_user_id: number,\r\n    date: Date,\r\n    wheather: number,\r\n    feeling: number,\r\n    text: string\r\n  ): Promise<Diary> {\r\n    const res = await fetch(\r\n      `${this.URI}${this.DIARY}`,\r\n      {\r\n        method: this.POST,\r\n        headers: this.HEADERS,\r\n        body: this.stringifyBody({\r\n          inner_user_id,\r\n          date: encodeDate(date),\r\n          wheather,\r\n          feeling,\r\n          text\r\n        })\r\n      }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n\r\n    return (await res.json()) as Diary;\r\n  }\r\n\r\n  public static async update(\r\n    diary_id: number,\r\n    date: Date | null,\r\n    wheather: number | null,\r\n    feeling: number | null,\r\n    text: string | null\r\n  ): Promise<Diary> {\r\n    \r\n    const body = {\r\n      diary_id,\r\n      date: date && encodeDate(date),\r\n      wheather,\r\n      feeling,\r\n      text\r\n    };\r\n\r\n    const res = await fetch(\r\n      `${this.URI}${this.DIARY}`,\r\n      {\r\n        method: this.PUT,\r\n        headers: this.HEADERS,\r\n        body: this.stringifyBody(body)\r\n      }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n\r\n    return (await res.json()) as Diary;\r\n  }\r\n\r\n  public static async delete(diary_id: number): Promise<void> {\r\n    const res = await fetch(\r\n      `${this.URI}${this.DIARY}${diary_id}`,\r\n      { method: this.DELETE }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n  }\r\n\r\n  private static stringifyBody(body: any): string {\r\n    return JSON.stringify(body, (_, v) => v != null ? v : undefined);\r\n  }\r\n\r\n  private static encodeRaw2Diary({ \r\n    inner_user_id,\r\n    diary_id,\r\n    date,\r\n    update_date,\r\n    wheather,\r\n    feeling,\r\n    text\r\n   }: RawDiary): Diary {\r\n    return {\r\n      inner_user_id,\r\n      diary_id,\r\n      date: new Date(date),\r\n      update_date: new Date(update_date),\r\n      wheather,\r\n      feeling,\r\n      text\r\n    };\r\n  }\r\n}","import { SelectTarget } from \"../hooks/DiaryHooks\";\r\nimport { Diary } from \"../model/Diary\";\r\nimport DiaryAPI from \"../utils/DiaryAPI\";\r\nimport { fixDate } from \"../utils/TimeUtils\";\r\n\r\nexport type OnSearch = (input: string, from?: Date, to?: Date) => Promise<void>;\r\nexport default function searchDiaries(\r\n  inner_user_id: number,\r\n  setDiaries: (value: React.SetStateAction<Diary[]>) => void,\r\n  setPage: (value: React.SetStateAction<boolean>) => void,\r\n  getDates: () => [Date | null, Date | null]\r\n): OnSearch {\r\n  return async function onSearch(input: string, from, to): Promise<void> {\r\n    const text: string | null = input === \"\" ? null : input;\r\n\r\n    const dates = (from && to) ? [fixDate(from, true), fixDate(to, false)] : getDates();\r\n\r\n    try {\r\n      const diaries = await DiaryAPI.search(\r\n        inner_user_id,\r\n        text,\r\n        dates[0],\r\n        dates[1]\r\n      );\r\n\r\n      setDiaries(diaries);\r\n    } catch(e) {\r\n      setDiaries([]);\r\n    } finally {\r\n      setPage(true);\r\n      setPage(false)\r\n    }\r\n  };\r\n}\r\n\r\nexport function getHandler(\r\n  target: Diary,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  onSearch: OnSearch,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): SelectTarget {\r\n  return {\r\n    diary: target,\r\n    saveHandler: getSaveHandler(target, setFilter, onSearch, setModalStatus),\r\n    deleteHandler: getDeleteHandler(target, setFilter, onSearch, setModalStatus),\r\n    cancelHandler: getCancelHandler(target, setModalStatus)\r\n  };\r\n}\r\n\r\nfunction getSaveHandler(\r\n  target: Diary,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  onSearch: OnSearch,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): ({ date, wheather, feeling, text }: Diary) => Promise<void> {\r\n  return async ({ date, wheather, feeling, text }) => {\r\n    const dateHasChanged = target.date.getTime() !== date.getTime();\r\n    const wheatherHasChanged  = target.wheather !== wheather;\r\n    const feelingHasChanged = target.feeling !== feeling;\r\n    const textHasChanged = target.text !== text;\r\n\r\n    if (!target.diary_id) return;\r\n    if (!(dateHasChanged || wheatherHasChanged || feelingHasChanged || textHasChanged)) {\r\n      alert('変更がありません');\r\n      return;\r\n    }\r\n\r\n    if (text.length < 10) {\r\n      alert('本文は10文字以上入力してください');\r\n      return;\r\n    }\r\n\r\n    const result = window.confirm('更新します');\r\n    if (!result) return;\r\n\r\n    try {\r\n      await DiaryAPI.update(\r\n        target.diary_id,\r\n        dateHasChanged ? date : null,\r\n        wheatherHasChanged ? wheather : null,\r\n        feelingHasChanged ? feeling : null,\r\n        textHasChanged ? text : null\r\n      );\r\n    } catch(e) {\r\n      alert(`更新できませんでした。 詳細: ${e.message}`);\r\n    } finally {\r\n      setFilter(date, date, false, true);\r\n      onSearch(\"\", date, date);\r\n      setModalStatus(false, null);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDeleteHandler(\r\n  target: Diary,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  onSearch: OnSearch,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): () => Promise<void> {\r\n  return async () => {\r\n    const result = window.confirm('本当に削除していいですか?');\r\n    if (!result) return;\r\n\r\n    if (target.diary_id === undefined) return;\r\n    try {\r\n      await DiaryAPI.delete(target.diary_id);\r\n  \r\n    } catch(e) {\r\n      alert(`削除できませんでした。 詳細: ${e.message}`);\r\n    } finally {\r\n      const to =new Date();\r\n      const from = new Date(to.getFullYear(), to.getMonth()-2, to.getDate());\r\n      setFilter(\r\n        from, to, false, false\r\n      );\r\n      onSearch(\"\", from, to);\r\n      setModalStatus(false, null)\r\n    }\r\n  }\r\n}\r\n\r\nfunction getCancelHandler(\r\n  target: Diary,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): () => Promise<void> {\r\n  return async () => {\r\n    const result = window.confirm('変更を破棄します');\r\n    if (!result) return;\r\n    setModalStatus(false, null);\r\n  };\r\n}\r\n","import { SelectTarget } from \"../hooks/DiaryHooks\";\r\nimport { Diary } from \"../model/Diary\";\r\nimport DiaryAPI from \"../utils/DiaryAPI\";\r\nimport { OnSearch } from \"./SearchHandler\";\r\n\r\nexport default function getDiaryTemplate(\r\n  inner_user_id: number,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  onSearch: OnSearch,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): SelectTarget {\r\n  const diary = getEmpty(inner_user_id);\r\n\r\n  const saveHandler = getSaveHandler(diary, setFilter, onSearch, setModalStatus);\r\n  const deleteHandler = getDeleteAndCancelHandler(setModalStatus);\r\n  return {\r\n    diary,\r\n    saveHandler,\r\n    deleteHandler,\r\n    cancelHandler: deleteHandler\r\n  }\r\n}\r\n\r\nfunction getEmpty(inner_user_id: number): Diary {\r\n  return {\r\n    inner_user_id,\r\n    date: new Date(),\r\n    wheather: 0,\r\n    feeling: 0,\r\n    text: '',\r\n  }\r\n}\r\n\r\nfunction getSaveHandler(\r\n  target: Diary,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  onSearch: OnSearch,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): ({ date, wheather, feeling, text }: Diary) => Promise<void> {\r\n  if (target.inner_user_id === undefined) throw new Error('ログインしなおしてください');\r\n\r\n  return async ({ date, wheather, feeling, text} ) => {\r\n    if (text.length < 10) {\r\n      alert('本文は10文字以上入力してください');\r\n      return;\r\n    }\r\n\r\n    const result = window.confirm('以下の内容で作成します')\r\n    if (!result) return;\r\n\r\n    try {\r\n      await DiaryAPI.insert(\r\n        target.inner_user_id as number,\r\n        date,\r\n        wheather,\r\n        feeling,\r\n        text\r\n      );\r\n\r\n    } catch(e) {\r\n      alert(`作成できませんでした。 詳細: ${e.message}`);\r\n\r\n    } finally {\r\n      setFilter(date, date, false, true);\r\n      onSearch(\"\", date, date);\r\n      setModalStatus(false, null);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDeleteAndCancelHandler(\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): () => Promise<void> {\r\n  return async () => {\r\n    const result = window.confirm('入力を破棄してもよろしいですか?');\r\n    if (!result) return;\r\n\r\n    setModalStatus(false, null);\r\n  }\r\n}","import React, { useCallback, useEffect } from 'react';\r\nimport SearchBar from './components/SearchBar';\r\nimport DiaryList from './components/DiaryList';\r\nimport { createStyles, Fab, makeStyles, Theme } from '@material-ui/core';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { Diary } from './model/Diary';\r\nimport DiaryModal from './components/DiaryModal';\r\nimport { useDiaryList, useModal, useSearchBar } from './hooks/DiaryHooks';\r\nimport searchDiaries, { getHandler } from './handlers/SearchHandler';\r\nimport getDiaryTemplate from './handlers/ModalHandler';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => \r\n  createStyles({\r\n    addIcon: {\r\n      position: 'fixed',\r\n      right: '3%',\r\n      bottom: '10%'\r\n    }\r\n  })\r\n);\r\n\r\ntype DiaryRoot = {\r\n  innerUserId: number;\r\n  userInfo: {\r\n    userName: string;\r\n    onLogout: () => void;\r\n  }\r\n};\r\nconst DiaryRoot: React.FC<DiaryRoot> = ({ innerUserId, userInfo }) => {\r\n  const classes = useStyles();\r\n\r\n  const [diaries, target, resetPage, setDiaries, setTarget, setResetPage] = useDiaryList();\r\n  const [open, edit, setModalStatus] = useModal(false, false);\r\n  const [filter, setFilter, getDates] = useSearchBar();\r\n\r\n  const onSearch = useCallback(searchDiaries(\r\n    innerUserId,\r\n    setDiaries,\r\n    setResetPage,\r\n    getDates\r\n  ), [innerUserId, searchDiaries, setDiaries, setResetPage, getDates]);\r\n\r\n  const onSelected = useCallback((target: Diary) => {\r\n    setTarget(getHandler(\r\n      target,\r\n      setFilter,\r\n      onSearch,\r\n      setModalStatus\r\n    ));\r\n    setModalStatus(true, false);\r\n  }, [onSearch, setFilter, setModalStatus, setTarget]);\r\n\r\n  const handleModalClose = useCallback(() => setModalStatus(false, null), [setModalStatus]);\r\n\r\n  const createNew = useCallback(() => {\r\n    setTarget(getDiaryTemplate(\r\n      innerUserId, setFilter, onSearch, setModalStatus\r\n    ));\r\n    setModalStatus(true, true);\r\n  }, [innerUserId, setTarget, setModalStatus, setFilter, onSearch]);\r\n  \r\n  const toggleEdit = useCallback(\r\n    () => setModalStatus(null, true), [setModalStatus]\r\n  );\r\n\r\n  // 初回検索\r\n  useEffect(() => {\r\n    onSearch(\"\")\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (  \r\n    <>\r\n      <SearchBar \r\n        onEnter={onSearch} \r\n        filter={filter} \r\n        userInfo={userInfo}\r\n        diaries={diaries}\r\n      />\r\n      <DiaryList \r\n        diaries={diaries} \r\n        onSelected={onSelected} \r\n        pageReset={resetPage} \r\n      />\r\n      <DiaryModal \r\n        selectTarget={target} \r\n        open={open} \r\n        edit={edit} \r\n        enterEdit={toggleEdit} \r\n        onClose={handleModalClose}\r\n      />\r\n      <Fab \r\n        color='primary' \r\n        aria-label='add' \r\n        className={classes.addIcon}\r\n        onClick={createNew}\r\n      >\r\n        <AddIcon />\r\n      </Fab>\r\n    </>\r\n  ); \r\n};\r\n\r\nexport default DiaryRoot;","import { MaterialUiPickersDate } from '@material-ui/pickers/typings/date';\r\nimport React, { useState } from 'react';\r\nimport { Filter } from '../components/SearchBar';\r\nimport { Diary, Feeling, Wheather } from '../model/Diary';\r\nimport { fixDate } from '../utils/TimeUtils';\r\n\r\nexport type SelectTarget = {\r\n  diary: Diary;\r\n  saveHandler: ({ date, wheather, feeling, text }: Diary) => Promise<void>;\r\n  deleteHandler: () => Promise<void>;\r\n  cancelHandler: () => Promise<void>;\r\n};\r\n\r\nexport function useDiaryList(): [\r\n  Diary[],\r\n  SelectTarget,\r\n  boolean,\r\n  React.Dispatch<React.SetStateAction<Diary[]>>,\r\n  React.Dispatch<React.SetStateAction<SelectTarget>>,\r\n  React.Dispatch<React.SetStateAction<boolean>>\r\n] {\r\n  const [diaries, setDiaries] = useState<Diary[]>([]);\r\n\r\n  const [target, setTarget] = useState<SelectTarget>({\r\n    diary: {\r\n      date: new Date(),\r\n      wheather: Wheather.SUNNY,\r\n      feeling: Feeling.HAPPY,\r\n      text: ''\r\n    },\r\n    saveHandler: async ({ date, wheather, feeling, text }) => {return},\r\n    deleteHandler: async () => {return},\r\n    cancelHandler: async () => {return}\r\n  });\r\n  const [resetPage, setResetPage] = useState(false);\r\n\r\n  return [diaries, target, resetPage, setDiaries, setTarget, setResetPage];\r\n}\r\n\r\nexport function useModal(init_open: boolean, init_edit: boolean): [\r\n  boolean,\r\n  boolean,\r\n  (open: boolean | null, edit: boolean | null) => void\r\n] {\r\n  const [open, setOpen] = useState(init_open);\r\n  const [edit, setEdit] = useState(init_edit);\r\n\r\n  function setModalStatus(open: boolean | null, edit: boolean | null) {\r\n    open !== null ? setOpen(open) : void(0);\r\n    edit !== null ? setEdit(edit) : void(0);\r\n  }\r\n\r\n  return [open, edit, setModalStatus];\r\n}\r\n\r\ntype useSearchBar = [\r\n  Filter,\r\n  (\r\n    from: Date,\r\n    to: Date,\r\n    fromDisabled: boolean,\r\n    toDisabled: boolean\r\n  ) => void,\r\n  () => [Date|null, Date|null]\r\n];\r\nexport function useSearchBar(): useSearchBar {\r\n  const [toDate, setToDate] = useState<Date>(new Date());\r\n  const [fromDate, setFromDate] = useState<Date>(\r\n    new Date(toDate.getFullYear(), toDate.getMonth()-2, toDate.getDate())\r\n  );\r\n\r\n  const [fromDisabled, setFromDisabled] = useState(false);\r\n  const [toDisabled, setToDisabled] = useState(false);\r\n\r\n  function setFilter(\r\n    from: Date,\r\n    to: Date,\r\n    fromDisabled: boolean,\r\n    toDisabled: boolean\r\n  ): void {\r\n    setFromDate(fixDate(from, true));\r\n    setToDate(fixDate(to, false));\r\n    setFromDisabled(fromDisabled);\r\n    setToDisabled(toDisabled);\r\n  }\r\n\r\n  const filter: Filter = {\r\n    from: {\r\n      date: fromDate,\r\n      onChange: (date: MaterialUiPickersDate) => setFromDate(date as Date),\r\n      onDisabled: (disabled: boolean) => setFromDisabled(disabled),\r\n      disabled: fromDisabled\r\n    },\r\n    to: {\r\n      date: toDate,\r\n      onChange: (date: MaterialUiPickersDate) => setToDate(date as Date),\r\n      onDisabled: (disabled: boolean) => setToDisabled(disabled),\r\n      disabled: toDisabled\r\n    }\r\n  };\r\n\r\n  function getDates(): [Date|null, Date|null] {\r\n    return [fromDisabled ? null : fromDate, toDisabled ? null : toDate];\r\n  }\r\n\r\n  return [filter, setFilter, getDates];\r\n}\r\n\r\n","import React, { useCallback, useRef } from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Link from '@material-ui/core/Link';\r\nimport Box from '@material-ui/core/Box';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright © '}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        Your Website\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.primary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}));\r\n\r\ntype Login = {\r\n  onLogin: (userId: string) => void;\r\n}\r\nexport default function Login({ onLogin }: Login) {\r\n  const classes = useStyles();\r\n\r\n  const idRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const handleOnLogin = useCallback(() => {\r\n    const userId = idRef.current ? idRef.current.value : '';\r\n\r\n    onLogin(userId);\r\n  }, [onLogin]);\r\n\r\n  const handleInputEnter = useCallback((event: React.KeyboardEvent<HTMLDivElement>): void => {\r\n    if ('Enter' !== event.key) return;\r\n\r\n    const userId = idRef.current ? idRef.current.value : '';\r\n\r\n    onLogin(userId);\r\n  }, [onLogin]);\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Login\r\n        </Typography>\r\n        <div className={classes.form}>\r\n          <TextField\r\n            inputRef={idRef}\r\n            onKeyPress={handleInputEnter}\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"user-id\"\r\n            label=\"User ID\"\r\n            name=\"user-id\"\r\n            autoFocus\r\n          />\r\n          <Button\r\n            onClick={handleOnLogin}\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={classes.submit}\r\n          >\r\n            Login\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}","import React from 'react';\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport jaLocale from 'date-fns/locale/ja'\n\nimport DiaryRoot from './DiaryRoot';\nimport Login from './Login';\nimport useLogin from './hooks/LoginHooks';\n\nfunction App() {\n  const [innerUserId, userName, onLogin, onLogout] = useLogin();\n\n  return (\n    <>\n      {innerUserId ? (\n        <MuiPickersUtilsProvider utils={DateFnsUtils} locale={jaLocale}>\n          <DiaryRoot \n            innerUserId={innerUserId} \n            userInfo={{\n              userName: userName || '',\n              onLogout: onLogout\n            }}\n          />\n        </MuiPickersUtilsProvider>\n      ):(\n        <Login onLogin={onLogin} />\n      )}\n    </>\n  );\n}\n\nexport default App;\n","import { useCallback, useState } from \"react\";\r\n\r\nexport default function useLogin(): [\r\n  number | null,\r\n  string | null,\r\n  (userId: string) => Promise<void>,\r\n  () => void\r\n] {\r\n  const [innerUserId, setInnerUserId] = useState<null | number>(null);\r\n  const [userName, setUserName] = useState<null | string>(null);\r\n\r\n  const onLogin = useCallback(async (userId: string) => {\r\n    if (!userId) {\r\n      alert('ユーザーIDを入力してください');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const res = await fetch(`../web_diary/user/${userId}`);\r\n      const userInfo = await res.json();\r\n      if (userInfo.error) {\r\n        alert(`ログインできませんでした。 詳細: ${userInfo.error.message}`);\r\n        return;\r\n      }\r\n      setInnerUserId(userInfo.inner_user_id);\r\n      setUserName(userInfo.user_name);\r\n    } catch(e) {\r\n      alert(`ログインできませんでした。詳細: ${e.message}`);\r\n    }\r\n  }, []);\r\n\r\n  const onLogout = useCallback(() => setInnerUserId(null), []);\r\n\r\n  return [innerUserId, userName, onLogin, onLogout];\r\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}