{"version":3,"sources":["components/SearchBar.tsx","handlers/DownloadHandler.tsx","utils/TimeUtils.ts","model/Diary.ts","components/DiaryList.tsx","components/DiaryModal.tsx","hooks/EditModalHooks.tsx","hooks/DiaryHooks.tsx","model/ModalStatus.ts","utils/DiaryAPI.ts","handlers/SearchHandler.tsx","handlers/ModalHandler.tsx","DiaryRoot.tsx","Login.tsx","utils/Theme.tsx","App.tsx","hooks/LoginHooks.tsx","serviceWorker.ts","index.tsx"],"names":["useStyles","makeStyles","theme","createStyles","grow","flexGrow","menuButton","marginRight","spacing","title","display","breakpoints","up","search","position","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","width","searchIcon","padding","height","pointerEvents","alignItems","justifyContent","inputRoot","color","inputInput","paddingLeft","transition","transitions","create","filterIcon","right","popover","popoverSearchButton","marginTop","SearchBar","onEnter","filter","userInfo","json","classes","useState","filterAnchor","setFilterAnchor","filterOpen","Boolean","filterId","undefined","handleFilterClick","useCallback","event","currentTarget","inputRef","useRef","handleFilterClose","current","value","handleInputEnter","key","handleDownloadClick","window","confirm","i","len","diaries","length","date","update_date","addZero","fileStr","JSON","stringify","blob","Blob","link","document","createElement","href","URL","createObjectURL","download","click","downloadDiaries","className","AppBar","Toolbar","IconButton","edge","aria-label","Typography","variant","noWrap","SearchTextField","filterEnabled","from","disabled","onKeyPress","onFilterClick","DateRangeSwitcher","to","open","onClose","id","onClick","UserMenu","userName","onLogout","InputBase","placeholder","root","input","inputProps","aria-controls","aria-haspopup","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","FormControlLabel","control","Switch","checked","onChange","onDisabled","target","name","label","DatePicker","format","disableFuture","minDate","React","setAnchorEl","isMenuOpen","handleMenuClose","menuId","Menu","keepMounted","MenuItem","encodeDate","getFullYear","zeroPadding","getMonth","getDate","getHours","getMinutes","getSeconds","fixDate","begin","result","Date","setHours","setMinutes","setSeconds","num","slice","date2String","year","month","day","hours","minutes","getDay","getDayOfTheWeek","Wheather","decodeWheather","wheather","Feeling","decodeFeeling","feeling","columns","minWidth","container","pagment","bottom","borderTop","margin","row","cursor","rowIndexColor","DiaryList","pageReset","onSelected","onReverse","page","setPage","rowsPerPage","setRowsPerPage","handleChangePage","newPage","handleChangeRowsPerPage","handleReverse","useEffect","Paper","TableContainer","Table","stickyHeader","TableHead","TableRow","map","column","TableCell","align","style","TableBody","diary","index","diary_id","hover","role","tabIndex","TablePagination","rowsPerPageOptions","component","count","onChangePage","onChangeRowsPerPage","modal","paper","background","maxWidth","boxShadow","shadows","enterEdit","textOverFlow","maxHeight","overflow","editTextMargin","editButtonWrapper","delete","close","DiaryModal","selectTarget","edit","normalBody","ViewBody","editBody","EditBody","Modal","aria-labelledby","aria-describedby","disableBackdropClick","closeAfterTransition","BackdropComponent","Backdrop","BackdropProps","timeout","Fade","in","disableStrictModeCompat","text","Fab","size","saveHandler","deleteHandler","cancelHandler","setDate","handleDateChange","setWheather","setFeeling","textRef","handleOnDelete","handleOnSave","handleOnClose","handleWChange","handleFChange","useEditModal","DateTimePicker","ampm","FormControl","Select","rows","defaultValue","multiline","fullWidth","rowsMax","fontSize","useModal","init_open","init_edit","setOpen","setEdit","OPEN","CLOSE","VIEW","EDIT","OPEN_WITH_VIEW","OPEN_WITH_EDIT","CLOSE_WITH_VIEW","DiaryAPI","inner_user_id","searchInput","fromDate","toDate","end_date","original","body","fetch","this","URI","SEARCH","method","POST","headers","HEADERS","stringifyBody","res","ok","Error","statusText","encodeRaw2Diary","reverse","DIARY","PUT","DELETE","_","v","getHandler","onSearch","setFilter","setModalStatus","setTarget","getSaveHandler","getDeleteHandler","getCancelHandler","a","dateHasChanged","getTime","wheatherHasChanged","feelingHasChanged","textHasChanged","alert","update","updatedDiary","message","getDiaryTemplate","getEmpty","insert","getDeleteAndCancelHandler","addIcon","DiaryRoot","innerUserId","setDiaries","setOriginal","useDiaryList","resetPage","setResetPage","setToDate","setFromDate","fromDisabled","setFromDisabled","toDisabled","setToDisabled","useSearchBar","getDates","dates","searchDiaries","concat","handleModalClose","createNew","toggleEdit","Copyright","Link","flexDirection","avatar","primary","main","form","submit","Login","onLogin","idRef","handleOnLogin","userId","Container","CssBaseline","Avatar","TextField","required","autoFocus","Button","type","Box","mt","createMuiTheme","secondary","App","setInnerUserId","setUserName","error","user_name","useLogin","ThemeProvider","utils","DateFnsUtils","locale","jaLocale","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","console"],"mappings":"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","file":"static/js/main.710d8845.chunk.js","sourcesContent":["import React, { useCallback, useRef, useState } from 'react';\r\nimport { fade, makeStyles, Theme, createStyles } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport ImportContactsIcon from '@material-ui/icons/ImportContacts';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle';\r\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport { FormControlLabel, Popover, Switch } from '@material-ui/core';\r\nimport { DatePicker } from '@material-ui/pickers';\r\nimport { MaterialUiPickersDate } from '@material-ui/pickers/typings/date';\r\nimport { downloadDiaries } from '../handlers/DownloadHandler';\r\nimport { SearchResponse } from '../utils/DiaryAPI';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    grow: {\r\n      flexGrow: 1,\r\n    },\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n    title: {\r\n      display: 'none',\r\n      [theme.breakpoints.up('sm')]: {\r\n        display: 'block',\r\n      },\r\n    },\r\n    search: {\r\n      position: 'relative',\r\n      borderRadius: theme.shape.borderRadius,\r\n      backgroundColor: fade(theme.palette.common.white, 0.15),\r\n      '&:hover': {\r\n        backgroundColor: fade(theme.palette.common.white, 0.25),\r\n      },\r\n      marginRight: theme.spacing(2),\r\n      marginLeft: 0,\r\n      width: '100%',\r\n      [theme.breakpoints.up('sm')]: {\r\n        marginLeft: theme.spacing(3),\r\n        width: 'auto',\r\n      },\r\n    },\r\n    searchIcon: {\r\n      padding: theme.spacing(0, 2),\r\n      height: '100%',\r\n      position: 'absolute',\r\n      pointerEvents: 'none',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n    },\r\n    inputRoot: {\r\n      color: 'inherit',\r\n    },\r\n    inputInput: {\r\n      padding: theme.spacing(1, 1, 1, 0),\r\n      paddingLeft: `calc(1em + ${theme.spacing(4)}px)`,\r\n      transition: theme.transitions.create('width'),\r\n      width: '100%',\r\n      [theme.breakpoints.up('md')]: {\r\n        width: '20ch',\r\n      },\r\n    },\r\n    filterIcon: {\r\n      position: 'absolute',\r\n      right: 0,\r\n      height: '100%',\r\n      padding: '0 12px'\r\n    },\r\n    popover: {\r\n      padding: '12px',\r\n    },\r\n    popoverSearchButton: {\r\n      marginTop: '10px',\r\n      display: 'flex',\r\n      justifyContent: 'flex-end'\r\n    }\r\n  }),\r\n);\r\n\r\ntype DateSwitch = {\r\n  date: Date;\r\n  disabled: boolean;\r\n  onChange: (date: MaterialUiPickersDate) => void;\r\n  onDisabled: (disabled: boolean) => void;\r\n}\r\nexport type Filter = {\r\n  from: DateSwitch,\r\n  to: DateSwitch\r\n};\r\ntype PrimarySearchAppBar = {\r\n  onEnter: (input: string) => void;\r\n  filter: Filter;\r\n  userInfo: {\r\n    userName: string;\r\n    onLogout: () => void;\r\n  },\r\n  json: SearchResponse\r\n};\r\nexport default function SearchBar({ onEnter, filter, userInfo, json }: PrimarySearchAppBar) {\r\n  const classes = useStyles();\r\n\r\n  const [filterAnchor, setFilterAnchor] = useState<HTMLButtonElement | null>(null);\r\n  const filterOpen = Boolean(filterAnchor);\r\n  const filterId = filterOpen ? 'filter-popover' : undefined;\r\n  \r\n  const handleFilterClick = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {\r\n    setFilterAnchor(event.currentTarget);\r\n  }, [setFilterAnchor]);\r\n\r\n  const inputRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const handleFilterClose = useCallback(() => {\r\n    onEnter(inputRef.current ? inputRef.current.value : \"\");\r\n    setFilterAnchor(null);\r\n  }, [onEnter, setFilterAnchor]);\r\n\r\n  const handleInputEnter = useCallback((event: React.KeyboardEvent<HTMLDivElement>): void => {\r\n    if ('Enter' === event.key)\r\n      onEnter(inputRef.current ? inputRef.current.value : \"\");\r\n  }, [onEnter]);\r\n\r\n  const handleDownloadClick = useCallback(() => downloadDiaries(json), [json]);\r\n  \r\n  return (\r\n    <div className={classes.grow}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <IconButton\r\n            edge=\"start\"\r\n            className={classes.menuButton}\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n          >\r\n            <ImportContactsIcon />\r\n          </IconButton>\r\n          <Typography className={classes.title} variant=\"h6\" noWrap>\r\n            Web Diary\r\n          </Typography>\r\n          <div className={classes.search}>\r\n            <SearchTextField \r\n              inputRef={inputRef}\r\n              filterId={filterId}\r\n              filterEnabled={!filter.from.disabled}\r\n              onKeyPress={handleInputEnter}\r\n              onFilterClick={handleFilterClick}\r\n            />\r\n            <DateRangeSwitcher \r\n              from={filter.from}\r\n              to={filter.to}\r\n              open={filterOpen}\r\n              filterAnchor={filterAnchor}\r\n              onClose={handleFilterClose}\r\n              id={filterId}\r\n            />\r\n          </div>\r\n          <IconButton color='inherit' onClick={handleDownloadClick}>\r\n            <CloudDownloadIcon />\r\n          </IconButton>\r\n          <UserMenu userName={userInfo.userName} onLogout={userInfo.onLogout} />\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  );\r\n}\r\n\r\ntype SearchTextField = {\r\n  onKeyPress: ((event: React.KeyboardEvent<HTMLDivElement>) => void) | undefined;\r\n  onFilterClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n  filterId: string | undefined;\r\n  filterEnabled: boolean;\r\n  inputRef: React.RefObject<HTMLTextAreaElement>;\r\n}\r\nfunction SearchTextField({ onKeyPress, onFilterClick, filterId, filterEnabled, inputRef }: SearchTextField): JSX.Element {\r\n  const classes = useStyles();\r\n  return (\r\n    <>\r\n      <div className={classes.searchIcon}>\r\n        <SearchIcon />\r\n      </div>\r\n      <InputBase\r\n        inputRef={inputRef}\r\n        placeholder=\"Search‚Ä¶\"\r\n        onKeyPress={onKeyPress}\r\n        classes={{\r\n        root: classes.inputRoot,\r\n        input: classes.inputInput,\r\n        }}\r\n        inputProps={{ 'aria-label': 'search' }}\r\n      />\r\n      <IconButton \r\n        className={classes.filterIcon}\r\n        aria-label=\"date-filter\"\r\n        aria-controls={filterId}\r\n        aria-haspopup=\"true\"\r\n        color={filterEnabled ? 'inherit' : 'secondary'}\r\n        onClick={onFilterClick}\r\n      >\r\n        <FilterListIcon />\r\n      </IconButton>\r\n    </>\r\n  );\r\n}\r\n\r\ntype Switcher = {\r\n  from: DateSwitch;\r\n  to: DateSwitch;\r\n  open: boolean;\r\n  filterAnchor: HTMLButtonElement | null;\r\n  onClose: () => any;\r\n  id: string | undefined;\r\n};\r\nfunction DateRangeSwitcher({ from, to, open, filterAnchor, onClose, id }: Switcher): JSX.Element {\r\n  const classes = useStyles();\r\n\r\n  const handleSwitchChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    from.onDisabled(!event.target.checked);\r\n    if (!event.target.checked)\r\n      to.onDisabled(!event.target.checked);\r\n  };\r\n\r\n  const handleToSwitchChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    to.onDisabled(!event.target.checked);\r\n  };\r\n\r\n  return (\r\n    <Popover\r\n      id={id}\r\n      open={open}\r\n      anchorEl={filterAnchor}\r\n      onClose={onClose}\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'center'\r\n      }}\r\n      transformOrigin={{\r\n        vertical: 'top',\r\n        horizontal: 'center'\r\n      }}\r\n    >\r\n      <div className={classes.popover}>\r\n        <FormControlLabel \r\n          control={\r\n            <Switch\r\n              checked={!from.disabled}\r\n              onChange={handleSwitchChange}\r\n              color='primary'\r\n              name='switch date filter'\r\n              inputProps={{ 'aria-label': 'enable date filter' }}\r\n            />\r\n          }\r\n          label=\"enable date filter\"\r\n        />\r\n        <div>\r\n          <DatePicker \r\n            disabled={from.disabled}\r\n            label=\"from\"\r\n            variant='inline'\r\n            value={from.date}\r\n            onChange={from.onChange}\r\n            format='yyyy/MM/dd'\r\n            disableFuture\r\n          />\r\n          <div>\r\n            <Switch\r\n              disabled={from.disabled}\r\n              checked={!to.disabled}\r\n              onChange={handleToSwitchChange}\r\n              color=\"primary\"\r\n              name=\"switch to date\"\r\n              inputProps={{ 'aria-label': 'to date checkbox' }}\r\n            />\r\n            <DatePicker \r\n              label=\"to\"\r\n              variant='inline'\r\n              value={to.date}\r\n              onChange={to.onChange}\r\n              format='yyyy/MM/dd'\r\n              disableFuture\r\n              disabled={to.disabled}\r\n              minDate={from.date}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Popover>\r\n  );\r\n}\r\n\r\ntype UserMenu = {\r\n  userName: string;\r\n  onLogout: () => void;\r\n}\r\nfunction UserMenu({ userName, onLogout }: UserMenu): JSX.Element {\r\n  const classes = useStyles();\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n\r\n  const isMenuOpen = Boolean(anchorEl);\r\n\r\n  const handleProfileMenuOpen = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleMenuClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const menuId = 'primary-search-account-menu';\r\n\r\n  return (\r\n    <>\r\n      <div className={classes.grow} />\r\n        <IconButton\r\n          aria-label=\"account of current user\"\r\n          aria-controls={menuId}\r\n          aria-haspopup=\"true\"\r\n          onClick={handleProfileMenuOpen}\r\n          color=\"inherit\"\r\n        >\r\n          <AccountCircle />\r\n        </IconButton>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n          id={menuId}\r\n          keepMounted\r\n          transformOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n          open={isMenuOpen}\r\n          onClose={handleMenuClose}\r\n        >\r\n          <MenuItem onClick={handleMenuClose}>{userName}</MenuItem>\r\n          <MenuItem onClick={onLogout}>Logout</MenuItem>\r\n        </Menu>\r\n    </>\r\n  )\r\n}","import { SearchResponse } from \"../utils/DiaryAPI\";\r\n\r\nexport function downloadDiaries(json: SearchResponse): void {\r\n  const result = window.confirm('Êó•Ë®òJSON„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åô');\r\n  if (!result) return;\r\n\r\n  addZero(json);\r\n  const fileStr = JSON.stringify(json);\r\n\r\n  const blob = new Blob(\r\n    [fileStr],\r\n    { \"type\": \"text/plain\" }\r\n  );\r\n\r\n  const link = document.createElement('a');\r\n  link.href = window.URL.createObjectURL(blob);\r\n  link.download = 'diaries.json';\r\n  link.click();\r\n}\r\n\r\nfunction addZero(json: SearchResponse): void {\r\n  const ADD = \".0\";\r\n  for (let i = 0, len = json.diaries.length; i < len; i++) {\r\n    json.diaries[i].date += ADD;\r\n    json.diaries[i].update_date += ADD;\r\n  }\r\n}","\r\nexport default function encodeDate(date: Date) {\r\n  return (\r\n    date.getFullYear() + '-' + \r\n        zeroPadding(date.getMonth() + 1) + '-' + \r\n        zeroPadding(date.getDate()) + 'T' +\r\n        zeroPadding(date.getHours()) + ':' +\r\n        zeroPadding(date.getMinutes()) + ':' +\r\n        zeroPadding(date.getSeconds()) + '.0'\r\n  );\r\n}\r\n\r\nexport function fixDate(date: Date, begin: boolean): Date {\r\n  const result = new Date(date);\r\n\r\n  result.setHours(begin ? 0 : 23);\r\n  result.setMinutes(begin ? 0 : 59);\r\n  result.setSeconds(begin ? 0 : 59);\r\n\r\n  return result;\r\n}\r\n\r\nfunction zeroPadding(num: number): string {\r\n  return ('0' + num).slice(-2);\r\n}\r\n\r\nexport function date2String(date: Date): string {\r\n  const year = date.getFullYear();\r\n  const month = date.getMonth() + 1;\r\n  const day = date.getDate();\r\n  const hours = date.getHours();\r\n  const minutes = date.getMinutes();\r\n\r\n  return `${year}/${zeroPadding(month)}/${zeroPadding(day)} ${getDayOfTheWeek(date)} ${zeroPadding(hours)}:${zeroPadding(minutes)}`;\r\n}\r\n\r\nfunction getDayOfTheWeek(date: Date): string {\r\n  return [\"Êó•\", \"Êúà\", \"ÁÅ´\", \"Ê∞¥\", \"Êú®\", \"Èáë\", \"Âúü\"][date.getDay()];\r\n}","export type RawDiary = {\r\n  inner_user_id: number;\r\n  diary_id: number;\r\n  date: string;\r\n  update_date: string;\r\n  wheather: number;\r\n  feeling: number;\r\n  text: string;\r\n};\r\n\r\nexport type Diary = {\r\n  inner_user_id?: number;\r\n  diary_id?: number;\r\n  date: Date;\r\n  end_date?: Date;\r\n  update_date?: Date;\r\n  wheather: number;\r\n  feeling: number;\r\n  text: string;\r\n};\r\n\r\nconst Wheather = {\r\n  SUNNY: 0,\r\n  CLOUDY: 1,\r\n  RAINY: 2,\r\n  THUNDER: 3,\r\n  SNOW: 4,\r\n  WIND: 5\r\n} as const;\r\ntype Wheather = typeof Wheather[keyof typeof Wheather];\r\n\r\nfunction decodeWheather(wheather: number): string {\r\n  switch(wheather) {\r\n    case(Wheather.SUNNY):\r\n      return 'üîÜ';\r\n    case(Wheather.CLOUDY):\r\n      return '‚òÅ';\r\n    case(Wheather.RAINY):\r\n      return '‚òî';\r\n    case(Wheather.THUNDER):\r\n      return '‚ö°';\r\n    case(Wheather.SNOW):\r\n      return '‚õÑ';\r\n    case(Wheather.WIND):\r\n      return 'üåÄ';\r\n    default:\r\n      return 'üîÜ';\r\n  };\r\n}\r\n\r\nconst Feeling = {\r\n  HAPPY: 0,\r\n  NORMAL: 1,\r\n  LIT_SAD: 2,\r\n  SAD: 3,\r\n  ANGRY: 4\r\n} as const;\r\ntype Feeling = typeof Feeling[keyof typeof Feeling];\r\n\r\nfunction decodeFeeling(feeling: number): string {\r\n  switch(feeling) {\r\n    case(Feeling.HAPPY):\r\n      return 'üòÄ';\r\n    case(Feeling.NORMAL):\r\n      return 'üòê';\r\n    case(Feeling.LIT_SAD):\r\n      return 'üò•';\r\n    case(Feeling.SAD):\r\n      return 'üò≠';\r\n    case(Feeling.ANGRY):\r\n      return 'üò°';\r\n    default:\r\n      return 'üòÄ';\r\n  };\r\n}\r\n\r\nexport { Wheather, decodeWheather, Feeling, decodeFeeling };","import React, { useEffect } from 'react';\r\nimport { useState, useCallback } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\n\r\nimport { date2String } from '../utils/TimeUtils';\r\nimport { Diary, decodeWheather, decodeFeeling } from '../model/Diary';\r\n\r\ntype Column = {\r\n  id: 'date' | 'wheather' | 'feeling' | 'text';\r\n  label: string;\r\n  minWidth?: number;\r\n  align?: 'center';\r\n  format?: (value: any) => string;\r\n};\r\n\r\nconst columns: Column[] = [\r\n  { id: 'date', label: 'Date', minWidth: 50, format: (value: Date) => date2String(value) },\r\n  { id: 'wheather', label: '', minWidth: 50, format: (value: number) => decodeWheather(value) },\r\n  { id: 'feeling', label: '', minWidth: 50, format: (value: number) => decodeFeeling(value) },\r\n  { id: 'text', label: 'Export', minWidth: 170, format: (value: string) => value.length > 100 ? value.slice(0, 100) + '...' : value }\r\n];\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    width: '100%'\r\n  },\r\n  container: {\r\n    height: 'calc(100vh - 115px)'\r\n  },\r\n  pagment: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    backgroundColor: '#fafafa',\r\n    borderTop: '1px solid rgba(0, 0, 0, 0.15)',\r\n    width: '100%',\r\n    margin: 0\r\n  },\r\n  row: {\r\n    cursor: 'pointer'\r\n  },\r\n  rowIndexColor: {\r\n    backgroundColor: \"#e6f6ea\"\r\n  }\r\n});\r\n\r\ntype DiaryList = {\r\n  diaries: Diary[];\r\n  pageReset: boolean;\r\n  onSelected: (target: Diary) => void;\r\n  onReverse: (diaries: Diary[]) => void;\r\n};\r\nexport default function DiaryList({ diaries, pageReset, onSelected, onReverse }: DiaryList) {\r\n  const classes = useStyles();\r\n  const [page, setPage] = useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = useState(25);\r\n\r\n  const handleChangePage = useCallback((event: unknown, newPage: number) => {\r\n    setPage(newPage);\r\n  }, []);\r\n\r\n  const handleChangeRowsPerPage = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setRowsPerPage(+event.target.value);\r\n    setPage(0);\r\n  }, []);\r\n\r\n  const handleReverse = useCallback(() => onReverse(diaries), [diaries, onReverse]);\r\n\r\n  useEffect(() => pageReset ? setPage(0) : void(0), [pageReset]);\r\n\r\n  return (\r\n    <Paper className={classes.root}>\r\n      <TableContainer className={classes.container}>\r\n        <Table stickyHeader aria-label=\"sticky table\">\r\n          <TableHead>\r\n            <TableRow onClick={handleReverse}>\r\n              {columns.map((column) => (\r\n                <TableCell\r\n                  key={column.id}\r\n                  align={column.align}\r\n                  style={{ minWidth: column.minWidth }}\r\n                >\r\n                  {column.label}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {diaries.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map((diary, index) => {\r\n              return (\r\n                <TableRow\r\n                  className={classes.row + \" \" + (index%2===0 ? classes.rowIndexColor : \"\")}\r\n                  key={diary.diary_id}\r\n                  hover \r\n                  role=\"checkbox\" \r\n                  tabIndex={-1}\r\n                  onClick={(event) => onSelected(diary)}\r\n                >\r\n                  {columns.map((column) => {\r\n                    const value = diary[column.id];\r\n                    return (\r\n                      <TableCell key={column.id} align={column.align}>\r\n                        {column.format ? column.format(value) : value}\r\n                      </TableCell>\r\n                    );\r\n                  })}\r\n                </TableRow>\r\n              );\r\n            })}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <TablePagination\r\n        className={classes.pagment}\r\n        rowsPerPageOptions={[10, 25, 100]}\r\n        component=\"div\"\r\n        count={diaries.length}\r\n        rowsPerPage={rowsPerPage}\r\n        page={page}\r\n        onChangePage={handleChangePage}\r\n        onChangeRowsPerPage={handleChangeRowsPerPage}\r\n      />\r\n    </Paper>\r\n  );\r\n}\r\n\r\n","import { createStyles, FormControl, InputBase, makeStyles, MenuItem, Modal, Select, Theme } from '@material-ui/core';\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport Fade from '@material-ui/core/Fade';\r\nimport React from 'react';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport NavigationIcon from '@material-ui/icons/Navigation';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\n\r\nimport {\r\n  Diary, Wheather, Feeling, decodeWheather, decodeFeeling\r\n} from '../model/Diary';\r\nimport useEditModal from '../hooks/EditModalHooks';\r\nimport { SelectTarget } from '../hooks/DiaryHooks';\r\nimport { date2String } from '../utils/TimeUtils';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    modal: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n    },\r\n    paper: {\r\n      position: 'relative',\r\n      backgroundColor: theme.palette.background.paper,\r\n      width: '80%',\r\n      maxWidth: '768px',\r\n      boxShadow: theme.shadows[5],\r\n      padding: theme.spacing(2, 4, 3),\r\n      borderRadius: '10px',\r\n      '& h2, p': {\r\n        cursor: 'default'\r\n      }\r\n    },\r\n    enterEdit: {\r\n      position: 'relative',\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      marginTop: '1%'\r\n    },\r\n    textOverFlow: {\r\n      width: '100%',\r\n      margin: 0,\r\n      maxHeight: '50vh',\r\n      overflow: 'auto'\r\n    },\r\n    editTextMargin: {\r\n      marginTop: '1%',\r\n    },\r\n    editButtonWrapper: {\r\n      width: '100%',\r\n      display: 'flex',\r\n      justifyContent: 'space-evenly'\r\n    },\r\n    delete: {\r\n      width: '50%'\r\n    },\r\n    close: {\r\n      width: '50%',\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      '& button': {\r\n        marginLeft: '1%'\r\n      }\r\n    }\r\n  }),\r\n);\r\n\r\ntype DiaryModal = {\r\n  selectTarget: SelectTarget;\r\n  open: boolean;\r\n  edit: boolean;\r\n  enterEdit: () => void;\r\n  onClose: () => void;\r\n}\r\nexport default function DiaryModal({ selectTarget, open, edit, enterEdit, onClose }: DiaryModal): JSX.Element {\r\n  const classes = useStyles();\r\n\r\n  const normalBody = (\r\n    <ViewBody\r\n      diary={selectTarget.diary}\r\n      onClick={enterEdit}\r\n    />\r\n  );\r\n\r\n  const editBody = (\r\n    <EditBody\r\n      selectTarget={selectTarget}\r\n    />\r\n  );\r\n  \r\n  return (\r\n    <Modal\r\n      aria-labelledby='transition-modal-title'\r\n      aria-describedby='transition-modal-description'\r\n      disableBackdropClick={edit}\r\n      className={classes.modal}\r\n      open={open}\r\n      onClose={onClose}\r\n      closeAfterTransition\r\n      BackdropComponent={Backdrop}\r\n      BackdropProps={{\r\n        timeout: 500,\r\n      }}\r\n    >\r\n      <Fade in={open} disableStrictModeCompat>\r\n        <>\r\n          {edit ? editBody : normalBody}\r\n        </>\r\n      </Fade>\r\n    </Modal>\r\n  );\r\n}\r\n\r\ntype ViewBody = {\r\n  diary: Diary;\r\n  onClick: () => void;\r\n}\r\nexport function ViewBody({ diary, onClick }: ViewBody) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div className={classes.paper}>\r\n      <h2 id='transition-modal-title'>\r\n        {date2String(diary.date) + \" \" + decodeWheather(diary.wheather) + \" \" + decodeFeeling(diary.feeling)}\r\n      </h2>\r\n      <p id='transition-modal-description' className={classes.textOverFlow}>{diary.text}</p>\r\n      <div className={classes.enterEdit}>\r\n        <Fab color=\"secondary\" aria-label=\"edit\" size='medium' onClick={onClick}>\r\n          <EditIcon />\r\n        </Fab>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\ntype EditBody = {\r\n  selectTarget: SelectTarget;\r\n}\r\nexport function EditBody({ selectTarget }: EditBody) {\r\n  const classes = useStyles();\r\n  const { diary } = selectTarget;\r\n  const { \r\n    date, wheather, feeling, textRef,\r\n    handleDateChange, handleWChange, handleFChange,\r\n    handleOnSave, handleOnClose, handleOnDelete\r\n  } = useEditModal(selectTarget);\r\n\r\n  return (\r\n    <div className={classes.paper}>\r\n      <DateTimePicker \r\n        value={date} \r\n        variant='inline'\r\n        onChange={handleDateChange}\r\n        ampm={false}\r\n        disableFuture\r\n        format='yyyy/MM/dd HH:mm'\r\n      />\r\n      <FormControl >\r\n        <Select \r\n          value={wheather}\r\n          onChange={handleWChange}\r\n        > \r\n          <MenuItem value={Wheather.SUNNY}>\r\n            <span role='img' aria-label='sunny'>{decodeWheather(Wheather.SUNNY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.CLOUDY}>\r\n            <span role='img' aria-label='cloudy'>{decodeWheather(Wheather.CLOUDY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.RAINY}>\r\n            <span role='img' aria-label='rainy'>{decodeWheather(Wheather.RAINY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.THUNDER}>\r\n            <span role='img' aria-label='thunder'>{decodeWheather(Wheather.THUNDER)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.SNOW}>\r\n            <span role='img' aria-label='snow'>{decodeWheather(Wheather.SNOW)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Wheather.WIND}>\r\n            <span role='img' aria-label='wind'>{decodeWheather(Wheather.WIND)}</span>\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n      <FormControl>\r\n        <Select\r\n          value={feeling}\r\n          onChange={handleFChange}\r\n        >\r\n          <MenuItem value={Feeling.HAPPY}>\r\n            <span role='img' aria-label='happy'>{decodeFeeling(Feeling.HAPPY)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.NORMAL}>\r\n            <span role='img' aria-label='normal'>{decodeFeeling(Feeling.NORMAL)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.LIT_SAD}>\r\n            <span role='img' aria-label='little-bit-sad'>{decodeFeeling(Feeling.LIT_SAD)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.SAD}>\r\n            <span role='img' aria-label='sad'>{decodeFeeling(Feeling.SAD)}</span>\r\n          </MenuItem>\r\n          <MenuItem value={Feeling.ANGRY}>\r\n            <span role='img' aria-label='angry'>{decodeFeeling(Feeling.ANGRY)}</span>\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n      <InputBase\r\n        inputRef={textRef}\r\n        className={classes.editTextMargin}\r\n        rows={20}\r\n        defaultValue={diary.text}\r\n        multiline\r\n        fullWidth\r\n        rowsMax={20}\r\n        inputProps={{ 'aria-label': 'naked' }}\r\n      />\r\n      <div className={classes.editButtonWrapper}>\r\n        <div className={classes.delete}>\r\n          <IconButton\r\n            onClick={handleOnDelete}\r\n            aria-label=\"delete\"\r\n          >\r\n            <DeleteIcon fontSize=\"small\" />\r\n          </IconButton>\r\n        </div>\r\n        <div className={classes.close}>\r\n          <Fab\r\n            onClick={handleOnSave}\r\n            variant=\"extended\"\r\n            size=\"medium\"\r\n            color=\"primary\"\r\n            aria-label=\"add\"\r\n          >\r\n            <NavigationIcon />\r\n            ‰øùÂ≠ò\r\n          </Fab>\r\n          <IconButton \r\n            aria-label='close' \r\n            onClick={handleOnClose}\r\n          >\r\n            <CloseIcon fontSize='small'/>\r\n          </IconButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { RefObject, useCallback, useRef, useState } from \"react\";\r\nimport { SelectTarget } from \"./DiaryHooks\";\r\n\r\nexport type UseEditModal = {\r\n  date: Date;\r\n  wheather: number;\r\n  feeling: number;\r\n  textRef: RefObject<HTMLTextAreaElement>;\r\n  handleDateChange: (date: any) => void;\r\n  handleWChange: (event: React.ChangeEvent<{value: unknown;}>) => void;\r\n  handleFChange: (event: React.ChangeEvent<{value: unknown;}>) => void;\r\n  handleOnSave: () => void;\r\n  handleOnClose: () => void;\r\n  handleOnDelete: () => void\r\n}\r\nexport default function useEditModal(selectTarget: SelectTarget): UseEditModal {\r\n  const { diary, saveHandler, deleteHandler, cancelHandler } = selectTarget;\r\n\r\n  const [date, setDate] = useState(diary.date);\r\n  const handleDateChange = useCallback((date) => setDate(date), []);\r\n\r\n  const [wheather, setWheather] = useState(diary.wheather);\r\n  const handleWChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    setWheather(event.target.value as number);\r\n  };\r\n  \r\n  const [feeling, setFeeling] = useState(diary.feeling);\r\n  const handleFChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    setFeeling(event.target.value as number);\r\n  };\r\n\r\n  const textRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const handleOnDelete = useCallback(() => {\r\n    deleteHandler()\r\n  }, [deleteHandler]);\r\n  \r\n  const handleOnSave = useCallback(() => {\r\n    const text = textRef.current ? textRef.current.value : \"\";\r\n    saveHandler({ date, wheather, feeling, text });\r\n  }, [date, feeling, saveHandler, wheather]);\r\n\r\n  const handleOnClose = useCallback(() => {\r\n    cancelHandler();\r\n  }, [cancelHandler]);\r\n\r\n  return {\r\n    date, \r\n    wheather, \r\n    feeling, \r\n    textRef,\r\n    handleDateChange, \r\n    handleWChange, \r\n    handleFChange,\r\n    handleOnDelete,\r\n    handleOnSave,\r\n    handleOnClose\r\n  };\r\n}","import { MaterialUiPickersDate } from '@material-ui/pickers/typings/date';\r\nimport React, { useState } from 'react';\r\nimport { Filter } from '../components/SearchBar';\r\nimport { Diary, Feeling, Wheather } from '../model/Diary';\r\nimport { SearchResponse } from '../utils/DiaryAPI';\r\nimport { fixDate } from '../utils/TimeUtils';\r\n\r\nexport type SelectTarget = {\r\n  diary: Diary;\r\n  saveHandler: ({ date, wheather, feeling, text }: Diary) => Promise<void>;\r\n  deleteHandler: () => Promise<void>;\r\n  cancelHandler: () => Promise<void>;\r\n};\r\n\r\nexport function useDiaryList(): [\r\n  Diary[],\r\n  SearchResponse,\r\n  SelectTarget,\r\n  boolean,\r\n  React.Dispatch<React.SetStateAction<Diary[]>>,\r\n  React.Dispatch<React.SetStateAction<SearchResponse>>,\r\n  React.Dispatch<React.SetStateAction<SelectTarget>>,\r\n  React.Dispatch<React.SetStateAction<boolean>>\r\n] {\r\n  const [diaries, setDiaries] = useState<Diary[]>([]);\r\n  const [original, setOriginal] = useState<SearchResponse>({ diaries: [] });\r\n\r\n  const [target, setTarget] = useState<SelectTarget>({\r\n    diary: {\r\n      date: new Date(),\r\n      wheather: Wheather.SUNNY,\r\n      feeling: Feeling.HAPPY,\r\n      text: ''\r\n    },\r\n    saveHandler: async ({ date, wheather, feeling, text }) => {return},\r\n    deleteHandler: async () => {return},\r\n    cancelHandler: async () => {return}\r\n  });\r\n  const [resetPage, setResetPage] = useState(false);\r\n\r\n  return [diaries, original, target, resetPage, setDiaries, setOriginal, setTarget, setResetPage];\r\n}\r\n\r\nexport function useModal(init_open: boolean, init_edit: boolean): [\r\n  boolean,\r\n  boolean,\r\n  (open: boolean | null, edit: boolean | null) => void\r\n] {\r\n  const [open, setOpen] = useState(init_open);\r\n  const [edit, setEdit] = useState(init_edit);\r\n\r\n  function setModalStatus(open: boolean | null, edit: boolean | null) {\r\n    open !== null ? setOpen(open) : void(0);\r\n    edit !== null ? setEdit(edit) : void(0);\r\n  }\r\n\r\n  return [open, edit, setModalStatus];\r\n}\r\n\r\ntype useSearchBar = [\r\n  Filter,\r\n  (\r\n    from: Date,\r\n    to: Date,\r\n    fromDisabled: boolean,\r\n    toDisabled: boolean\r\n  ) => void,\r\n  () => [Date|null, Date|null]\r\n];\r\nexport function useSearchBar(): useSearchBar {\r\n  const [toDate, setToDate] = useState<Date>(new Date());\r\n  const [fromDate, setFromDate] = useState<Date>(\r\n    new Date(toDate.getFullYear(), toDate.getMonth()-2, toDate.getDate())\r\n  );\r\n\r\n  const [fromDisabled, setFromDisabled] = useState(false);\r\n  const [toDisabled, setToDisabled] = useState(false);\r\n\r\n  function setFilter(\r\n    from: Date,\r\n    to: Date,\r\n    fromDisabled: boolean,\r\n    toDisabled: boolean\r\n  ): void {\r\n    setFromDate(fixDate(from, true));\r\n    setToDate(fixDate(to, false));\r\n    setFromDisabled(fromDisabled);\r\n    setToDisabled(toDisabled);\r\n  }\r\n\r\n  const filter: Filter = {\r\n    from: {\r\n      date: fromDate,\r\n      onChange: (date: MaterialUiPickersDate) => setFromDate(date as Date),\r\n      onDisabled: (disabled: boolean) => setFromDisabled(disabled),\r\n      disabled: fromDisabled\r\n    },\r\n    to: {\r\n      date: toDate,\r\n      onChange: (date: MaterialUiPickersDate) => setToDate(date as Date),\r\n      onDisabled: (disabled: boolean) => setToDisabled(disabled),\r\n      disabled: toDisabled\r\n    }\r\n  };\r\n\r\n  function getDates(): [Date|null, Date|null] {\r\n    return [fromDisabled ? null : fromDate, toDisabled ? null : toDate];\r\n  }\r\n\r\n  return [filter, setFilter, getDates];\r\n}\r\n\r\n","const Modal = {\r\n  OPEN: [true, null],\r\n  CLOSE: [false, null],\r\n  VIEW: [null, false],\r\n  EDIT: [null, true],\r\n  OPEN_WITH_VIEW: [true, false],\r\n  OPEN_WITH_EDIT: [true, true],\r\n  CLOSE_WITH_VIEW: [false, false]\r\n} as const;\r\ntype Modal = typeof Modal[keyof typeof Modal];\r\n\r\nexport default Modal;","import { RawDiary, Diary } from '../model/Diary';\r\nimport encodeDate, { fixDate } from './TimeUtils';\r\n\r\nexport type SearchResponse = {\r\n  diaries: RawDiary[]\r\n};\r\nexport default class DiaryAPI {\r\n  private static URI = '../web_diary/';\r\n  private static DIARY = 'diary/';\r\n  private static SEARCH = 'search/';\r\n\r\n  private static POST = 'POST';\r\n  private static PUT = 'PUT';\r\n  private static DELETE = 'DELETE';\r\n\r\n  private static HEADERS = {\r\n    'Content-Type': 'application/json'\r\n  };\r\n\r\n  public static async search(\r\n    inner_user_id: number, \r\n    searchInput: string | null, \r\n    fromDate: Date | null, \r\n    toDate: Date | null\r\n  ): Promise<{\r\n    diaries: Diary[],\r\n    original: SearchResponse\r\n  }> {\r\n\r\n    let date: Date | null;\r\n    let end_date: Date | null;\r\n    if (fromDate && toDate) {\r\n      date = fixDate(fromDate, true);\r\n      end_date = fixDate(toDate, false);\r\n    } else if (fromDate && !toDate) {\r\n      date = fixDate(fromDate, true);\r\n      end_date = fixDate(fromDate, false);\r\n    } else {\r\n      date = null;\r\n      end_date = null;\r\n    }\r\n\r\n    if (!fromDate && !toDate && !searchInput) return { diaries: [], original: { diaries: [] } };\r\n\r\n    const body = {\r\n      inner_user_id,\r\n      text: searchInput,\r\n      date: date && encodeDate(date),\r\n      end_date: end_date && encodeDate(end_date)\r\n    };\r\n\r\n    const res = await fetch(\r\n      `${this.URI}${this.SEARCH}`,\r\n      {\r\n        method: this.POST,\r\n        headers: this.HEADERS,\r\n        body: this.stringifyBody(body)\r\n      }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n\r\n    const json: SearchResponse = await res.json();\r\n\r\n    return {\r\n      diaries: json.diaries.map(this.encodeRaw2Diary).reverse(),\r\n      original: json\r\n    };\r\n  }\r\n\r\n  public static async insert(\r\n    inner_user_id: number,\r\n    date: Date,\r\n    wheather: number,\r\n    feeling: number,\r\n    text: string\r\n  ): Promise<Diary> {\r\n    const res = await fetch(\r\n      `${this.URI}${this.DIARY}`,\r\n      {\r\n        method: this.POST,\r\n        headers: this.HEADERS,\r\n        body: this.stringifyBody({\r\n          inner_user_id,\r\n          date: encodeDate(date),\r\n          wheather,\r\n          feeling,\r\n          text\r\n        })\r\n      }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n\r\n    return this.encodeRaw2Diary(await res.json());\r\n  }\r\n\r\n  public static async update(\r\n    diary_id: number,\r\n    date: Date | null,\r\n    wheather: number | null,\r\n    feeling: number | null,\r\n    text: string | null\r\n  ): Promise<Diary> {\r\n    \r\n    const body = {\r\n      diary_id,\r\n      date: date && encodeDate(date),\r\n      wheather,\r\n      feeling,\r\n      text\r\n    };\r\n\r\n    const res = await fetch(\r\n      `${this.URI}${this.DIARY}`,\r\n      {\r\n        method: this.PUT,\r\n        headers: this.HEADERS,\r\n        body: this.stringifyBody(body)\r\n      }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n\r\n    return this.encodeRaw2Diary(await res.json());\r\n  }\r\n\r\n  public static async delete(diary_id: number): Promise<void> {\r\n    const res = await fetch(\r\n      `${this.URI}${this.DIARY}${diary_id}`,\r\n      { method: this.DELETE }\r\n    );\r\n\r\n    if (!res.ok) throw new Error(res.statusText);\r\n  }\r\n\r\n  private static stringifyBody(body: any): string {\r\n    return JSON.stringify(body, (_, v) => v != null ? v : undefined);\r\n  }\r\n\r\n  private static encodeRaw2Diary({ \r\n    inner_user_id,\r\n    diary_id,\r\n    date,\r\n    update_date,\r\n    wheather,\r\n    feeling,\r\n    text\r\n   }: RawDiary): Diary {\r\n    return {\r\n      inner_user_id,\r\n      diary_id,\r\n      date: new Date(date),\r\n      update_date: new Date(update_date),\r\n      wheather,\r\n      feeling,\r\n      text\r\n    };\r\n  }\r\n}","import { SelectTarget } from \"../hooks/DiaryHooks\";\r\nimport { Diary } from \"../model/Diary\";\r\nimport Modal from \"../model/ModalStatus\";\r\nimport DiaryAPI, { SearchResponse } from \"../utils/DiaryAPI\";\r\nimport { fixDate } from \"../utils/TimeUtils\";\r\n\r\nexport type OnSearch = (input: string, from?: Date, to?: Date) => Promise<void>;\r\nexport default function searchDiaries(\r\n  inner_user_id: number,\r\n  setDiaries: (value: React.SetStateAction<Diary[]>) => void,\r\n  setOriginal: (value: React.SetStateAction<SearchResponse>) => void,\r\n  setPage: (value: React.SetStateAction<boolean>) => void,\r\n  getDates: () => [Date | null, Date | null]\r\n): OnSearch {\r\n  return async function onSearch(input, from, to): Promise<void> {\r\n    const text: string | null = input === \"\" ? null : input;\r\n\r\n    const dates = (from && to) ? [fixDate(from, true), fixDate(to, false)] : getDates();\r\n\r\n    try {\r\n      const { diaries, original } = await DiaryAPI.search(\r\n        inner_user_id,\r\n        text,\r\n        dates[0],\r\n        dates[1]\r\n      );\r\n\r\n      setOriginal(original);\r\n      setDiaries(diaries);\r\n    } catch(e) {\r\n      setDiaries([]);\r\n    } finally {\r\n      setPage(true);\r\n      setPage(false);\r\n    }\r\n  };\r\n}\r\n\r\nexport function getHandler(\r\n  target: Diary,\r\n  onSearch: OnSearch,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void,\r\n  setTarget: React.Dispatch<React.SetStateAction<SelectTarget>>\r\n): SelectTarget {\r\n  return {\r\n    diary: target,\r\n    saveHandler: getSaveHandler(target, onSearch, setFilter, setModalStatus, setTarget),\r\n    deleteHandler: getDeleteHandler(target, onSearch, setFilter, setModalStatus),\r\n    cancelHandler: getCancelHandler(setModalStatus)\r\n  };\r\n}\r\n\r\nfunction getSaveHandler(\r\n  target: Diary,\r\n  onSearch: OnSearch,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void,\r\n  setTarget: React.Dispatch<React.SetStateAction<SelectTarget>>\r\n): ({ date, wheather, feeling, text }: Diary) => Promise<void> {\r\n  return async ({ date, wheather, feeling, text }) => {\r\n    const dateHasChanged = target.date.getTime() !== date.getTime();\r\n    const wheatherHasChanged  = target.wheather !== wheather;\r\n    const feelingHasChanged = target.feeling !== feeling;\r\n    const textHasChanged = target.text !== text;\r\n\r\n    if (!target.diary_id) return;\r\n    if (!(dateHasChanged || wheatherHasChanged || feelingHasChanged || textHasChanged)) {\r\n      alert('Â§âÊõ¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');\r\n      return;\r\n    }\r\n\r\n    if (text.length < 10) {\r\n      alert('Êú¨Êñá„ÅØ10ÊñáÂ≠ó‰ª•‰∏äÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\r\n      return;\r\n    }\r\n\r\n    const result = window.confirm('Êõ¥Êñ∞„Åó„Åæ„Åô');\r\n    if (!result) return;\r\n\r\n    try {\r\n      const updatedDiary = await DiaryAPI.update(\r\n        target.diary_id,\r\n        dateHasChanged ? date : null,\r\n        wheatherHasChanged ? wheather : null,\r\n        feelingHasChanged ? feeling : null,\r\n        textHasChanged ? text : null\r\n      );\r\n\r\n      setTarget(getHandler(\r\n        updatedDiary,\r\n        onSearch,\r\n        setFilter,\r\n        setModalStatus,\r\n        setTarget\r\n      ));\r\n\r\n    } catch(e) {\r\n      alert(`Êõ¥Êñ∞„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ Ë©≥Á¥∞: ${e.message}`);\r\n    } finally {\r\n      const from = new Date(date.getFullYear(), date.getMonth() - 2, date.getDate());\r\n      setFilter(from, date, false, false);\r\n      onSearch(\"\", from, date);\r\n      setModalStatus(...Modal.OPEN_WITH_VIEW);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDeleteHandler(\r\n  target: Diary,\r\n  onSearch: OnSearch,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): () => Promise<void> {\r\n  return async () => {\r\n    const result = window.confirm('Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Å¶„ÅÑ„ÅÑ„Åß„Åô„Åã?');\r\n    if (!result) return;\r\n\r\n    if (target.diary_id === undefined) return;\r\n    try {\r\n      await DiaryAPI.delete(target.diary_id);\r\n      const to =new Date();\r\n      const from = new Date(to.getFullYear(), to.getMonth()-2, to.getDate());\r\n      setFilter(\r\n        from, to, false, false\r\n      );\r\n      onSearch(\"\", from, to);\r\n      setModalStatus(...Modal.CLOSE)\r\n  \r\n    } catch(e) {\r\n      alert(`ÂâäÈô§„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ Ë©≥Á¥∞: ${e.message}`);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getCancelHandler(\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): () => Promise<void> {\r\n  return async () => {\r\n    const result = window.confirm('Â§âÊõ¥„ÇíÁ†¥Ê£Ñ„Åó„Åæ„Åô');\r\n    if (!result) return;\r\n    setModalStatus(...Modal.OPEN_WITH_VIEW);\r\n  };\r\n}\r\n","import { SelectTarget } from \"../hooks/DiaryHooks\";\r\nimport { Diary } from \"../model/Diary\";\r\nimport Modal from \"../model/ModalStatus\";\r\nimport DiaryAPI from \"../utils/DiaryAPI\";\r\nimport { getHandler, OnSearch } from \"./SearchHandler\";\r\n\r\nexport default function getDiaryTemplate(\r\n  inner_user_id: number,\r\n  onSearch: OnSearch,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void,\r\n  setTarget: React.Dispatch<React.SetStateAction<SelectTarget>>\r\n): SelectTarget {\r\n  const diary = getEmpty(inner_user_id);\r\n\r\n  const saveHandler = getSaveHandler(diary, onSearch, setFilter, setModalStatus, setTarget);\r\n  const deleteHandler = getDeleteAndCancelHandler(setModalStatus);\r\n  return {\r\n    diary,\r\n    saveHandler,\r\n    deleteHandler,\r\n    cancelHandler: deleteHandler\r\n  }\r\n}\r\n\r\nfunction getEmpty(inner_user_id: number): Diary {\r\n  return {\r\n    inner_user_id,\r\n    date: new Date(),\r\n    wheather: 0,\r\n    feeling: 0,\r\n    text: '',\r\n  }\r\n}\r\n\r\nfunction getSaveHandler(\r\n  target: Diary,\r\n  onSearch: OnSearch,\r\n  setFilter: (from: Date, to: Date, fromDisabled: boolean, toDisabled: boolean) => void,\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void,\r\n  setTarget: React.Dispatch<React.SetStateAction<SelectTarget>>\r\n): ({ date, wheather, feeling, text }: Diary) => Promise<void> {\r\n  if (target.inner_user_id === undefined) throw new Error('„É≠„Ç∞„Ç§„É≥„Åó„Å™„Åä„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\r\n\r\n  return async ({ date, wheather, feeling, text} ) => {\r\n    if (text.length < 10) {\r\n      alert('Êú¨Êñá„ÅØ10ÊñáÂ≠ó‰ª•‰∏äÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\r\n      return;\r\n    }\r\n\r\n    const result = window.confirm('‰ª•‰∏ã„ÅÆÂÜÖÂÆπ„Åß‰ΩúÊàê„Åó„Åæ„Åô')\r\n    if (!result) return;\r\n\r\n    try {\r\n      const result = await DiaryAPI.insert(\r\n        target.inner_user_id as number,\r\n        date,\r\n        wheather,\r\n        feeling,\r\n        text\r\n      );\r\n      \r\n      setTarget(getHandler(\r\n        result,\r\n        onSearch,\r\n        setFilter,\r\n        setModalStatus,\r\n        setTarget\r\n      ));\r\n\r\n    } catch(e) {\r\n      alert(`‰ΩúÊàê„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ Ë©≥Á¥∞: ${e.message}`);\r\n\r\n    } finally {\r\n      const from = new Date(date.getFullYear(), date.getMonth() - 2, date.getDate());\r\n      setFilter(from, date, false, false);\r\n      onSearch(\"\", from, date);\r\n      setModalStatus(...Modal.OPEN_WITH_VIEW);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDeleteAndCancelHandler(\r\n  setModalStatus: (open: boolean | null, edit: boolean | null) => void\r\n): () => Promise<void> {\r\n  return async () => {\r\n    const result = window.confirm('ÂÖ•Âäõ„ÇíÁ†¥Ê£Ñ„Åó„Å¶„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„Åã?');\r\n    if (!result) return;\r\n\r\n    setModalStatus(...Modal.CLOSE);\r\n  }\r\n}","import React, { useCallback, useEffect } from 'react';\r\nimport SearchBar from './components/SearchBar';\r\nimport DiaryList from './components/DiaryList';\r\nimport { createStyles, Fab, makeStyles, Theme } from '@material-ui/core';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { Diary } from './model/Diary';\r\nimport DiaryModal from './components/DiaryModal';\r\nimport { useDiaryList, useModal, useSearchBar } from './hooks/DiaryHooks';\r\nimport searchDiaries, { getHandler } from './handlers/SearchHandler';\r\nimport getDiaryTemplate from './handlers/ModalHandler';\r\nimport Modal from './model/ModalStatus';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => \r\n  createStyles({\r\n    addIcon: {\r\n      position: 'fixed',\r\n      right: '3%',\r\n      bottom: '10%'\r\n    }\r\n  })\r\n);\r\n\r\ntype DiaryRoot = {\r\n  innerUserId: number;\r\n  userInfo: {\r\n    userName: string;\r\n    onLogout: () => void;\r\n  }\r\n};\r\nconst DiaryRoot: React.FC<DiaryRoot> = ({ innerUserId, userInfo }) => {\r\n  const classes = useStyles();\r\n\r\n  const [diaries, original, target, resetPage, setDiaries, setOriginal, setTarget, setResetPage] = useDiaryList();\r\n  const [open, edit, setModalStatus] = useModal(...Modal.CLOSE_WITH_VIEW);\r\n  const [filter, setFilter, getDates] = useSearchBar();\r\n\r\n  const onSearch = useCallback(searchDiaries(\r\n    innerUserId,\r\n    setDiaries,\r\n    setOriginal,\r\n    setResetPage,\r\n    getDates\r\n  ), [innerUserId, setOriginal, setDiaries, setResetPage, getDates]);\r\n\r\n  const onSelected = useCallback((target: Diary) => {\r\n    setTarget(getHandler(\r\n      target,\r\n      onSearch,\r\n      setFilter, \r\n      setModalStatus,\r\n      setTarget\r\n    ));\r\n    setModalStatus(...Modal.OPEN_WITH_VIEW);\r\n  }, [onSearch, setFilter, setModalStatus, setTarget]);\r\n\r\n  const onReverse = useCallback((diaries: Diary[]) => setDiaries(([] as Diary[]).concat(diaries).reverse()), [setDiaries]);\r\n\r\n  const handleModalClose = useCallback(() => setModalStatus(...Modal.CLOSE), [setModalStatus]);\r\n\r\n  const createNew = useCallback(() => {\r\n    setTarget(getDiaryTemplate(\r\n      innerUserId, onSearch, setFilter, setModalStatus, setTarget\r\n    ));\r\n    setModalStatus(...Modal.OPEN_WITH_EDIT);\r\n  }, [innerUserId, setTarget, setModalStatus, setFilter, onSearch]);\r\n  \r\n  const toggleEdit = useCallback(\r\n    () => setModalStatus(...Modal.EDIT), [setModalStatus]\r\n  );\r\n\r\n  // ÂàùÂõûÊ§úÁ¥¢\r\n  useEffect(() => {\r\n    onSearch(\"\")\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (  \r\n    <>\r\n      <SearchBar \r\n        onEnter={onSearch} \r\n        filter={filter} \r\n        userInfo={userInfo}\r\n        json={original}\r\n      />\r\n      <DiaryList \r\n        diaries={diaries} \r\n        pageReset={resetPage}\r\n        onSelected={onSelected} \r\n        onReverse={onReverse} \r\n      />\r\n      <DiaryModal \r\n        selectTarget={target} \r\n        open={open} \r\n        edit={edit} \r\n        enterEdit={toggleEdit} \r\n        onClose={handleModalClose}\r\n      />\r\n      <Fab \r\n        color='primary' \r\n        aria-label='add' \r\n        className={classes.addIcon}\r\n        onClick={createNew}\r\n      >\r\n        <AddIcon />\r\n      </Fab>\r\n    </>\r\n  ); \r\n};\r\n\r\nexport default DiaryRoot;","import React, { useCallback, useRef } from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Link from '@material-ui/core/Link';\r\nimport Box from '@material-ui/core/Box';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright ¬© '}\r\n      <Link color=\"inherit\" href=\"\">\r\n        Takanori Kusumoto\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(16),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.primary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}));\r\n\r\ntype Login = {\r\n  onLogin: (userId: string) => void;\r\n}\r\nexport default function Login({ onLogin }: Login) {\r\n  const classes = useStyles();\r\n\r\n  const idRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const handleOnLogin = useCallback(() => {\r\n    const userId = idRef.current ? idRef.current.value : '';\r\n\r\n    onLogin(userId);\r\n  }, [onLogin]);\r\n\r\n  const handleInputEnter = useCallback((event: React.KeyboardEvent<HTMLDivElement>): void => {\r\n    if ('Enter' !== event.key) return;\r\n\r\n    const userId = idRef.current ? idRef.current.value : '';\r\n\r\n    onLogin(userId);\r\n  }, [onLogin]);\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Login\r\n        </Typography>\r\n        <div className={classes.form}>\r\n          <TextField\r\n            inputRef={idRef}\r\n            onKeyPress={handleInputEnter}\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"user-id\"\r\n            label=\"User ID\"\r\n            name=\"user-id\"\r\n            autoFocus\r\n          />\r\n          <Button\r\n            onClick={handleOnLogin}\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={classes.submit}\r\n          >\r\n            Login\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}","import { createMuiTheme } from '@material-ui/core/styles';\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#26a69a'\r\n    },\r\n    secondary: {\r\n      main: '#005655'\r\n    }\r\n  }\r\n});\r\n\r\nexport default theme;","import React from 'react';\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport jaLocale from 'date-fns/locale/ja'\n\nimport DiaryRoot from './DiaryRoot';\nimport Login from './Login';\nimport useLogin from './hooks/LoginHooks';\nimport { ThemeProvider } from '@material-ui/core';\nimport theme from './utils/Theme';\n\nfunction App() {\n  const [innerUserId, userName, onLogin, onLogout] = useLogin();\n\n  return (\n    <ThemeProvider theme={theme}>\n      {innerUserId ? (\n        <MuiPickersUtilsProvider utils={DateFnsUtils} locale={jaLocale}>\n          <DiaryRoot \n            innerUserId={innerUserId} \n            userInfo={{\n              userName: userName || '',\n              onLogout: onLogout\n            }}\n          />\n        </MuiPickersUtilsProvider>\n      ):(\n        <Login onLogin={onLogin} />\n      )}\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import { useCallback, useState } from \"react\";\r\n\r\nexport default function useLogin(): [\r\n  number | null,\r\n  string | null,\r\n  (userId: string) => Promise<void>,\r\n  () => void\r\n] {\r\n  const [innerUserId, setInnerUserId] = useState<null | number>(null);\r\n  const [userName, setUserName] = useState<null | string>(null);\r\n\r\n  const onLogin = useCallback(async (userId: string) => {\r\n    if (!userId) {\r\n      alert('„É¶„Éº„Ç∂„ÉºID„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const res = await fetch(`../web_diary/user/${userId}`);\r\n      const userInfo = await res.json();\r\n      if (userInfo.error) {\r\n        alert(`„É≠„Ç∞„Ç§„É≥„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ Ë©≥Á¥∞: ${userInfo.error.message}`);\r\n        return;\r\n      }\r\n      setInnerUserId(userInfo.inner_user_id);\r\n      setUserName(userInfo.user_name);\r\n    } catch(e) {\r\n      alert(`„É≠„Ç∞„Ç§„É≥„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇË©≥Á¥∞: ${e.message}`);\r\n    }\r\n  }, []);\r\n\r\n  const onLogout = useCallback(() => setInnerUserId(null), []);\r\n\r\n  return [innerUserId, userName, onLogin, onLogout];\r\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}